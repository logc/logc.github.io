((3) 0 () 26 ((p+ #"/Users/luis/Documents/code/logc.github.io/_src/posts/2015-07-15-open-files-from-last-commit-in-vim.markdown" . unix) (p+ #"/Users/luis/Documents/code/logc.github.io/_src/posts/2018-08-10-setting-java-home-for-sbt-inside-emacs-gui.md" . unix) (p+ #"/Users/luis/Documents/code/logc.github.io/_src/posts/2018-04-30-git-setup-with-fork-and-upstream.md" . unix) (p+ #"/Users/luis/Documents/code/logc.github.io/_src/posts/2016-09-23-racket-and-vim-syntastic.md" . unix) (p+ #"/Users/luis/Documents/code/logc.github.io/_src/posts/2018-08-07-produce-small-executables-with-common-lisp.md" . unix) (p+ #"/Users/luis/Documents/code/logc.github.io/_src/posts/2018-08-09-ensime-server-crashed-by-wrong-jar.md" . unix) (p+ #"/Users/luis/Documents/code/logc.github.io/_src/posts/2014-04-01-python-egg-tagged-with-git-commit-hash.markdown" . unix) (p+ #"/Users/luis/Documents/code/logc.github.io/_src/posts/2015-02-27-if-programming-languages-were-music-genres.markdown" . unix) (p+ #"/Users/luis/Documents/code/logc.github.io/_src/posts/2013-11-17-infraestructura-de-lanzamientos-locales.markdown" . unix) (p+ #"/Users/luis/Documents/code/logc.github.io/_src/posts/2013-12-04-instalar-python-2-dot-7-y-numpy-sobre-redhat-6.markdown" . unix) (p+ #"/Users/luis/Documents/code/logc.github.io/_src/posts/2014-01-21-wordcount-in-c-plus-plus.markdown" . unix) (p+ #"/Users/luis/Documents/code/logc.github.io/_src/posts/2017-08-15-some-git-aliases.md" . unix) (p+ #"/Users/luis/Documents/code/logc.github.io/_src/posts/2018-08-24-what-to-learn-in-a-new-programming-language.md" . unix) (p+ #"/Users/luis/Documents/code/logc.github.io/_src/posts/2017-09-05-ensime-server-crash-because-of-transitive-dependency.md" . unix) (p+ #"/Users/luis/Documents/code/logc.github.io/_src/posts/2017-12-19-minimal-racket-web-app.md" . unix) (p+ #"/Users/luis/Documents/code/logc.github.io/_src/posts/2013-12-03-unicode-encodings.markdown" . unix) (p+ #"/Users/luis/Documents/code/logc.github.io/_src/posts/2018-05-14-debug-scala-with-spacemacs.md" . unix) (p+ #"/Users/luis/Documents/code/logc.github.io/_src/posts/2018-06-04-logging-start-and-finish-in-python.md" . unix) (p+ #"/Users/luis/Documents/code/logc.github.io/_src/posts/2017-08-25-maven-does-not-find-java-home-in-fish-shell.md" . unix) (p+ #"/Users/luis/Documents/code/logc.github.io/_src/posts/2017-08-24-intellij-context-menu-from-keyboard.md" . unix) (p+ #"/Users/luis/Documents/code/logc.github.io/_src/posts/2014-01-20-reduce-in-standard-c-plus-plus.markdown" . unix) (p+ #"/Users/luis/Documents/code/logc.github.io/_src/posts/2013-12-04-how-do-you-develop-with-yesod.markdown" . unix) (p+ #"/Users/luis/Documents/code/logc.github.io/_src/posts/2016-10-20-minimal-c-project-structure-with-scons.md" . unix) (p+ #"/Users/luis/Documents/code/logc.github.io/_src/posts/2016-10-03-setting-up-github-pages-with-frog.md" . unix) (p+ #"/Users/luis/Documents/code/logc.github.io/_src/posts/2013-11-19-compilar-cython.markdown" . unix) (p+ #"/Users/luis/Documents/code/logc.github.io/_src/posts/2013-12-02-py2app-excludes.markdown" . unix)) () (h ! (equal) ((? . 0) f post (u . "Open files from last commit in Vim") (? . 0) 1535126483 (p+ #"/Users/luis/Documents/code/logc.github.io/blog/2015/07/15/open-files-from-last-commit-in-vim/index.html" . unix) (u . "/blog/2015/07/15/open-files-from-last-commit-in-vim/") (u . "2015-07-15T11:05:47Z+0200") (? . 7) (? . 3) (c (u . "vim") c (u . "git")) (u . "\n<p>It is always a nuisance to remember which files were you working on when you last exited your editing session. I have tried different approaches, including:</p>\n\n<ul>\n <li>leaving a test that does not succeed in order to get an errortrace that  points to the next task I should tackle</li>\n <li>opening the editor inside a <code>tmux</code> or <code>screen</code> session, and therefore never  ending the editing session</li></ul>\n\n<p>The last idea I had was to create a unfinished Git commit (called &ldquo;Unfinished: The commit title&rdquo;), and use Git to retrieve the name of the files that were touched in that commit. You can do it like this:</p>\n\n<pre><code>$ git log --pretty=format: --name-only -n 1</code></pre>\n\n<p>If you alias that command in your <code>.gitconfig</code>, e.g. to <code>lastedited</code>, you can then open the files in your editor by command subtitution:</p>\n\n<pre><code>$ vim $(git lastedited)</code></pre>") #f (u . "\n<p>It is always a nuisance to remember which files were you working on when you last exited your editing session. I have tried different approaches, including:</p>\n\n<ul>\n <li>leaving a test that does not succeed in order to get an errortrace that  points to the next task I should tackle</li>\n <li>opening the editor inside a <code>tmux</code> or <code>screen</code> session, and therefore never  ending the editing session</li></ul>\n\n<p>The last idea I had was to create a unfinished Git commit (called &ldquo;Unfinished: The commit title&rdquo;), and use Git to retrieve the name of the files that were touched in that commit. You can do it like this:</p>\n\n<pre><code>$ git log --pretty=format: --name-only -n 1</code></pre>\n\n<p>If you alias that command in your <code>.gitconfig</code>, e.g. to <code>lastedited</code>, you can then open the files in your editor by command subtitution:</p>\n\n<pre><code>$ vim $(git lastedited)</code></pre>")) ((? . 1) f post (u . "Setting JAVA_HOME for SBT inside Emacs GUI") (? . 1) 1535126483 (p+ #"/Users/luis/Documents/code/logc.github.io/blog/2018/08/10/setting-java-home-for-sbt-inside-emacs-gui/index.html" . unix) (u . "/blog/2018/08/10/setting-java-home-for-sbt-inside-emacs-gui/") (u . "2018-08-10T12:06:41") (? . 5) (? . 12) (c (u . "scala") c (u . "spacemacs")) (u . "\n<p>Is your terminal SBT and your Emacs (or Spacemacs) SBT giving you different results? More confusingly, is SBT doing the correct thing from inside Emacs if Emacs is started from the terminal and not as a GUI application?</p>\n\n<p>This can be caused by Emacs producing its own environment if started as a GUI application! (And you thought all environments were created equal, out of <code>.bashrc</code> or whatever &hellip; Nope.)</p>\n\n<p>This new env that Emacs creates for itself is based on &hellip; magic, I guess.</p>\n\n<p>In any case, it does <em>not</em> necessarily respect the <code>JAVA_HOME</code> that you carefully set in your normal (terminal) environment.</p>\n\n<p>In order to correct this, add to your <code>init.el</code> (or <code>dotspacemacs/user-init</code> in <code>.spacemacs</code>):</p>\n\n<pre><code>(setenv \"JAVA_HOME\"\n        \"/Library/Java/JavaVirtualMachines/jdk1.8.0_172.jdk/Contents/Home/\")</code></pre>\n\n<p>or whatever it is that <code>JAVA_HOME</code> should point to.</p>\n\n<p>As an alternative, you can set this variable per project by adding a file <code>.sbtopts</code> in the project root with the following:</p>\n\n<pre><code>-java-home\n/Library/Java/JavaVirtualMachines/jdk1.8.0_172.jdk/Contents/Home/</code></pre>") #f (u . "\n<p>Is your terminal SBT and your Emacs (or Spacemacs) SBT giving you different results? More confusingly, is SBT doing the correct thing from inside Emacs if Emacs is started from the terminal and not as a GUI application?</p>\n\n<p>This can be caused by Emacs producing its own environment if started as a GUI application! (And you thought all environments were created equal, out of <code>.bashrc</code> or whatever &hellip; Nope.)</p>\n\n<p>This new env that Emacs creates for itself is based on &hellip; magic, I guess.</p>\n\n<p>In any case, it does <em>not</em> necessarily respect the <code>JAVA_HOME</code> that you carefully set in your normal (terminal) environment.</p>\n\n<p>In order to correct this, add to your <code>init.el</code> (or <code>dotspacemacs/user-init</code> in <code>.spacemacs</code>):</p>\n\n<pre><code>(setenv \"JAVA_HOME\"\n        \"/Library/Java/JavaVirtualMachines/jdk1.8.0_172.jdk/Contents/Home/\")</code></pre>\n\n<p>or whatever it is that <code>JAVA_HOME</code> should point to.</p>\n\n<p>As an alternative, you can set this variable per project by adding a file <code>.sbtopts</code> in the project root with the following:</p>\n\n<pre><code>-java-home\n/Library/Java/JavaVirtualMachines/jdk1.8.0_172.jdk/Contents/Home/</code></pre>")) ((? . 2) f post (u . "Git setup with fork and upstream") (? . 2) 1535126483 (p+ #"/Users/luis/Documents/code/logc.github.io/blog/2018/04/30/git-setup-with-fork-and-upstream/index.html" . unix) (u . "/blog/2018/04/30/git-setup-with-fork-and-upstream/") (u . "2018-04-30T11:46:41") (? . 14) (? . 16) (c (u . "git")) (u . "\n<p>Here is how to setup a fresh clone of a git repository so that it pulls changes from an upstream, but only pushes by default to another repository (usually, your own fork of the project).</p>\n\n<p>I use the fish shell. If you use Bash or Zsh it should be straightforward to define these variables in your environment.</p>\n\n<div class=\"brush: fish\">\n <div class=\"highlight\">\n  <pre><span></span><span class=\"k\">set</span> gituser logc\n<span class=\"k\">set</span> gitproject chat\n<span class=\"k\">set</span> gitorg NacionLumpen\n</pre></div>\n\n</div>\n\n<p>And this is how to setup the clone:</p>\n\n<div class=\"brush: fish\">\n <div class=\"highlight\">\n  <pre><span></span>git clone git@github.com:<span class=\"nv\">$gituser</span>/<span class=\"nv\">$gitproject</span>.git\n<span class=\"k\">cd</span> <span class=\"nv\">$gitproject</span>\ngit remote add upstream git@github.com:<span class=\"nv\">$gitorg</span>/<span class=\"nv\">$gitproject</span>.git\ngit remote rename origin fork\ngit fetch upstream\ngit branch --set-upstream-to<span class=\"o\">=</span>upstream/master\ngit config remote.pushDefault fork\n</pre></div>\n\n</div>\n\n<p>As always with git, it is trivial, if your name is &lsquo;Linus&rsquo; :)</p>") #f (u . "\n<p>Here is how to setup a fresh clone of a git repository so that it pulls changes from an upstream, but only pushes by default to another repository (usually, your own fork of the project).</p>\n\n<p>I use the fish shell. If you use Bash or Zsh it should be straightforward to define these variables in your environment.</p>\n\n<div class=\"brush: fish\">\n <div class=\"highlight\">\n  <pre><span></span><span class=\"k\">set</span> gituser logc\n<span class=\"k\">set</span> gitproject chat\n<span class=\"k\">set</span> gitorg NacionLumpen\n</pre></div>\n\n</div>\n\n<p>And this is how to setup the clone:</p>\n\n<div class=\"brush: fish\">\n <div class=\"highlight\">\n  <pre><span></span>git clone git@github.com:<span class=\"nv\">$gituser</span>/<span class=\"nv\">$gitproject</span>.git\n<span class=\"k\">cd</span> <span class=\"nv\">$gitproject</span>\ngit remote add upstream git@github.com:<span class=\"nv\">$gitorg</span>/<span class=\"nv\">$gitproject</span>.git\ngit remote rename origin fork\ngit fetch upstream\ngit branch --set-upstream-to<span class=\"o\">=</span>upstream/master\ngit config remote.pushDefault fork\n</pre></div>\n\n</div>\n\n<p>As always with git, it is trivial, if your name is &lsquo;Linus&rsquo; :)</p>")) ((? . 3) f post (u . "Racket and vim-syntastic") (? . 3) 1535126483 (p+ #"/Users/luis/Documents/code/logc.github.io/blog/2016/09/23/racket-and-vim-syntastic/index.html" . unix) (u . "/blog/2016/09/23/racket-and-vim-syntastic/") (u . "2016-09-23T21:48:27") (? . 0) (? . 23) (c (u . "racket") c (u . "vim")) (u . "\n<p>The current Syntastic checker for Racket syntax in Vim is the <code>racket</code> executable itself. This means that the current buffer is executed by Racket whenever it is checked for syntax, and this can have unintended consequences, e.g. entering an infinite loop, if you happen to open the wrong file.</p>\n\n<p>In order to just get the syntax errors, add this to your <code>.vimrc</code>:</p>\n\n<pre><code>let g:syntastic_racket_racket_args=\"--load\"</code></pre>") #f (u . "\n<p>The current Syntastic checker for Racket syntax in Vim is the <code>racket</code> executable itself. This means that the current buffer is executed by Racket whenever it is checked for syntax, and this can have unintended consequences, e.g. entering an infinite loop, if you happen to open the wrong file.</p>\n\n<p>In order to just get the syntax errors, add this to your <code>.vimrc</code>:</p>\n\n<pre><code>let g:syntastic_racket_racket_args=\"--load\"</code></pre>")) ((? . 4) f post (u . "Produce small executables with Common Lisp") (? . 4) 1535126483 (p+ #"/Users/luis/Documents/code/logc.github.io/blog/2018/08/07/produce-small-executables-with-common-lisp/index.html" . unix) (u . "/blog/2018/08/07/produce-small-executables-with-common-lisp/") (u . "2018-08-07T11:14:18") (? . 17) (? . 5) (c (u . "lisp")) (u . "\n<p>You need <a href=\"https://github.com/roswell/roswell\">roswell</a>, <a href=\"https://common-lisp.net/project/ecl/\">ECL</a> and <a href=\"https://upx.github.io/\">UPX</a> installed.</p>\n\n<pre><code>$ brew install --HEAD roswell\n$ brew install ecl upx\n</code></pre>\n\n<p>The reason to install the head roswell is that, as of this writing, some of the Common Lisp installations did not work on the latest release on Homebrew.</p>\n\n<p>The reason to install <code>ecl</code> on the system, and not using <code>ros install</code>, is that I had problems installing the latest version of ECL that way. Also, the <code>ros\nlist versions</code> command did not find any available versions of ECL. So, I resorted to using the system installed ECL.</p>\n\n<pre><code>$ ros use ecl/system</code></pre>") #t (u . "\n<p>You need <a href=\"https://github.com/roswell/roswell\">roswell</a>, <a href=\"https://common-lisp.net/project/ecl/\">ECL</a> and <a href=\"https://upx.github.io/\">UPX</a> installed.</p>\n\n<pre><code>$ brew install --HEAD roswell\n$ brew install ecl upx\n</code></pre>\n\n<p>The reason to install the head roswell is that, as of this writing, some of the Common Lisp installations did not work on the latest release on Homebrew.</p>\n\n<p>The reason to install <code>ecl</code> on the system, and not using <code>ros install</code>, is that I had problems installing the latest version of ECL that way. Also, the <code>ros\nlist versions</code> command did not find any available versions of ECL. So, I resorted to using the system installed ECL.</p>\n\n<pre><code>$ ros use ecl/system</code></pre>\n<!-- more-->\n\n<p>Initialize a new roswell script</p>\n\n<pre><code>$ ros init hello</code></pre>\n\n<p>Then add the following to <code>hello.ros</code></p>\n\n<div class=\"brush: lisp\">\n <div class=\"highlight\">\n  <pre><span></span><span class=\"err\">#</span><span class=\"nv\">!/bin/sh</span>\n<span class=\"cm\">#|-*- mode:lisp -*-|#</span>\n<span class=\"cm\">#|</span>\n<span class=\"cm\">exec ros -Q -- $0 \"$@\"</span>\n<span class=\"cm\">|#</span>\n<span class=\"p\">(</span><span class=\"k\">progn</span> <span class=\"c1\">;;init forms</span>\n  <span class=\"c1\">;;(ros:ensure-asdf)</span>\n  <span class=\"c1\">;;#+quicklisp(ql:quickload &#39;() :silent t)</span>\n  <span class=\"p\">)</span>\n\n<span class=\"p\">(</span><span class=\"nb\">defpackage</span> <span class=\"ss\">:ros.script.hello.3742624530</span>\n  <span class=\"p\">(</span><span class=\"ss\">:use</span> <span class=\"ss\">:cl</span><span class=\"p\">))</span>\n<span class=\"p\">(</span><span class=\"nb\">in-package</span> <span class=\"ss\">:ros.script.hello.3742624530</span><span class=\"p\">)</span>\n\n\n<span class=\"p\">(</span><span class=\"nb\">defun</span> <span class=\"nv\">main</span> <span class=\"p\">(</span><span class=\"k\">&amp;rest</span> <span class=\"nv\">argv</span><span class=\"p\">)</span>\n  <span class=\"p\">(</span><span class=\"k\">declare</span> <span class=\"p\">(</span><span class=\"k\">ignorable</span> <span class=\"nv\">argv</span><span class=\"p\">))</span>\n  <span class=\"p\">(</span><span class=\"nb\">format</span> <span class=\"no\">t</span> <span class=\"s\">\"Hello world!~%\"</span><span class=\"p\">))</span>\n<span class=\"c1\">;;; vim: set ft=lisp lisp:</span>\n</pre></div>\n\n</div>\n\n<p>Compile into an executable using</p>\n\n<pre><code>$ ros build hello.ros</code></pre>\n\n<p>The executable <code>hello</code> is now 1.6 MB on my system (Darwin 17.7.0)</p>\n\n<p>You can bring this down to 457 KB using</p>\n\n<pre><code>$ upx --best hello</code></pre>\n\n<p>The &ldquo;hello&rdquo; executable is now small, but not really fast</p>\n\n<pre><code>$ time ./hello\nHello world!\n        0.41 real         0.40 user         0.02 sys</code></pre>")) ((? . 6) f post (u . "Python egg tagged with Git commit hash") (? . 6) 1535126483 (p+ #"/Users/luis/Documents/code/logc.github.io/blog/2014/04/01/python-egg-tagged-with-git-commit-hash/index.html" . unix) (u . "/blog/2014/04/01/python-egg-tagged-with-git-commit-hash/") (u . "2014-04-01T15:22:00Z+0200") (? . 10) (? . 7) (c (u . "python") c (u . "git")) (u . "\n<h2 id=\"svn\">SVN</h2>\n\n<p>Python&rsquo;s setuptools provide a simple mechanism to tag your built distributions with the SVN revision they belong to, by creating a <code>setup.cfg</code> file along the normal <code>setup.py</code>, and there write</p>\n\n<pre><code>[egg_info]\n# Add svn revision to the file name\ntag_svn_revision = 1</code></pre>\n\n<h2 id=\"git\">Git</h2>\n\n<p>How to do the same for Git? Or in general, with other information? (Date tagging is also supported by default).</p>\n\n<p>Answer: modify directly the <code>options</code> dictionary in the call to <code>setup</code>, in <code>setup.py</code>. There, you can put anything you can compute with Python or system calls. E.g. for git:</p>\n\n<div class=\"brush: python\">\n <div class=\"highlight\">\n  <pre><span></span><span class=\"kn\">import</span> <span class=\"nn\">shlex</span>\n<span class=\"kn\">from</span> <span class=\"nn\">subprocess</span> <span class=\"kn\">import</span> <span class=\"n\">check_output</span>\n\n<span class=\"n\">GIT_HEAD_REV</span> <span class=\"o\">=</span> <span class=\"n\">check_output</span><span class=\"p\">(</span><span class=\"n\">shlex</span><span class=\"o\">.</span><span class=\"n\">split</span><span class=\"p\">(</span><span class=\"s1\">&#39;git rev-parse --short HEAD&#39;</span><span class=\"p\">))</span><span class=\"o\">.</span><span class=\"n\">strip</span><span class=\"p\">()</span>\n\n\n<span class=\"n\">setup</span><span class=\"p\">(</span>\n    <span class=\"c1\"># ... other keys like project name, version, etc ...</span>\n    <span class=\"n\">options</span> <span class=\"o\">=</span> <span class=\"nb\">dict</span><span class=\"p\">(</span><span class=\"n\">egg_info</span> <span class=\"o\">=</span> <span class=\"nb\">dict</span><span class=\"p\">(</span><span class=\"n\">tag_build</span> <span class=\"o\">=</span> <span class=\"s2\">\"dev_\"</span> <span class=\"o\">+</span> <span class=\"n\">GIT_HEAD_REV</span><span class=\"p\">)),</span>\n<span class=\"p\">)</span>\n</pre></div>\n\n</div>\n\n<p>With that setup, distributions (<code>sdist</code> or <code>bdist</code>) would be tagged with the string &ldquo;dev&rdquo; and the git hash of the latest commit:</p>\n\n<div class=\"brush: console\">\n <div class=\"highlight\">\n  <pre><span></span><span class=\"gp\">$</span> bin/python setup.py sdist bdist_egg\n<span class=\"gp\">$</span> ls dist\n<span class=\"go\">pyhello-0.1dev-92ffa06.tar.gz    pyhello-0.1dev_92ffa06-py2.7.egg</span>\n</pre></div>\n\n</div>\n\n<p>Whenever you want to build a stable release (without any &ldquo;dev&rdquo; tags), just set the key to empty in your <code>setup.cfg</code>, like this:</p>\n\n<pre><code>[egg_info]\ntag_build =</code></pre>") #f (u . "\n<h2 id=\"svn\">SVN</h2>\n\n<p>Python&rsquo;s setuptools provide a simple mechanism to tag your built distributions with the SVN revision they belong to, by creating a <code>setup.cfg</code> file along the normal <code>setup.py</code>, and there write</p>\n\n<pre><code>[egg_info]\n# Add svn revision to the file name\ntag_svn_revision = 1</code></pre>\n\n<h2 id=\"git\">Git</h2>\n\n<p>How to do the same for Git? Or in general, with other information? (Date tagging is also supported by default).</p>\n\n<p>Answer: modify directly the <code>options</code> dictionary in the call to <code>setup</code>, in <code>setup.py</code>. There, you can put anything you can compute with Python or system calls. E.g. for git:</p>\n\n<div class=\"brush: python\">\n <div class=\"highlight\">\n  <pre><span></span><span class=\"kn\">import</span> <span class=\"nn\">shlex</span>\n<span class=\"kn\">from</span> <span class=\"nn\">subprocess</span> <span class=\"kn\">import</span> <span class=\"n\">check_output</span>\n\n<span class=\"n\">GIT_HEAD_REV</span> <span class=\"o\">=</span> <span class=\"n\">check_output</span><span class=\"p\">(</span><span class=\"n\">shlex</span><span class=\"o\">.</span><span class=\"n\">split</span><span class=\"p\">(</span><span class=\"s1\">&#39;git rev-parse --short HEAD&#39;</span><span class=\"p\">))</span><span class=\"o\">.</span><span class=\"n\">strip</span><span class=\"p\">()</span>\n\n\n<span class=\"n\">setup</span><span class=\"p\">(</span>\n    <span class=\"c1\"># ... other keys like project name, version, etc ...</span>\n    <span class=\"n\">options</span> <span class=\"o\">=</span> <span class=\"nb\">dict</span><span class=\"p\">(</span><span class=\"n\">egg_info</span> <span class=\"o\">=</span> <span class=\"nb\">dict</span><span class=\"p\">(</span><span class=\"n\">tag_build</span> <span class=\"o\">=</span> <span class=\"s2\">\"dev_\"</span> <span class=\"o\">+</span> <span class=\"n\">GIT_HEAD_REV</span><span class=\"p\">)),</span>\n<span class=\"p\">)</span>\n</pre></div>\n\n</div>\n\n<p>With that setup, distributions (<code>sdist</code> or <code>bdist</code>) would be tagged with the string &ldquo;dev&rdquo; and the git hash of the latest commit:</p>\n\n<div class=\"brush: console\">\n <div class=\"highlight\">\n  <pre><span></span><span class=\"gp\">$</span> bin/python setup.py sdist bdist_egg\n<span class=\"gp\">$</span> ls dist\n<span class=\"go\">pyhello-0.1dev-92ffa06.tar.gz    pyhello-0.1dev_92ffa06-py2.7.egg</span>\n</pre></div>\n\n</div>\n\n<p>Whenever you want to build a stable release (without any &ldquo;dev&rdquo; tags), just set the key to empty in your <code>setup.cfg</code>, like this:</p>\n\n<pre><code>[egg_info]\ntag_build =</code></pre>")) ((? . 8) f post (u . "Infraestructura de lanzamientos locales") (? . 8) 1535126483 (p+ #"/Users/luis/Documents/code/logc.github.io/blog/2013/11/17/infraestructura-de-lanzamientos-locales/index.html" . unix) (u . "/blog/2013/11/17/infraestructura-de-lanzamientos-locales/") (u . "2013-11-17T21:43:12Z+0100") #f (? . 24) (c (u . "sysadmin")) (u . "\n<p>Este post describe cómo crear una infraestructura de lanzamientos locales, para compartir paquetes locales con otros desarrolladores del mismo equipo, basándose en Python y Macports. Esto presupone que los otros miembros del equipo usan todos Mac OS X, y que están interesados en usar paquetes de Python, claro.</p>\n\n<p>Necesitaremos:</p>\n\n<ul>\n <li>crear un paquete de Python con su correspondiente <code>setup.py</code></li>\n <li>tener un directorio <code>releases</code> servido por HTTP por el servidor Apache  integrado en el sistema operativo.</li>\n <li>tener un directorio <code>ports</code> servido por rsync.</li>\n <li>configurar Macports para usar este nuevo repositorio.</li></ul>") #t (u . "\n<p>Este post describe cómo crear una infraestructura de lanzamientos locales, para compartir paquetes locales con otros desarrolladores del mismo equipo, basándose en Python y Macports. Esto presupone que los otros miembros del equipo usan todos Mac OS X, y que están interesados en usar paquetes de Python, claro.</p>\n\n<p>Necesitaremos:</p>\n\n<ul>\n <li>crear un paquete de Python con su correspondiente <code>setup.py</code></li>\n <li>tener un directorio <code>releases</code> servido por HTTP por el servidor Apache  integrado en el sistema operativo.</li>\n <li>tener un directorio <code>ports</code> servido por rsync.</li>\n <li>configurar Macports para usar este nuevo repositorio.</li></ul>\n<!-- more-->\n\n<h2 id=\"crear-un-paquete-de-ejemplo-en-python\">Crear un paquete de ejemplo en Python</h2>\n\n<p>Crea un directorio llamado <code>pyhello</code>, y los siguientes directorios y ficheros dentro de él:</p>\n\n<div class=\"brush: console\">\n <div class=\"highlight\">\n  <pre><span></span><span class=\"go\">.</span>\n<span class=\"go\">├── pyhello</span>\n<span class=\"go\">│   ├── __init__.py</span>\n<span class=\"go\">│   └── main.py</span>\n<span class=\"go\">└── setup.py</span>\n</pre></div>\n\n</div>\n\n<p>El contenido de <code>setup.py</code>:</p>\n\n<div class=\"brush: python\">\n <div class=\"highlight\">\n  <pre><span></span><span class=\"kn\">from</span> <span class=\"nn\">setuptools</span> <span class=\"kn\">import</span> <span class=\"n\">setup</span>\n\n<span class=\"n\">setup</span><span class=\"p\">(</span><span class=\"n\">name</span><span class=\"o\">=</span><span class=\"s1\">&#39;pyhello&#39;</span><span class=\"p\">,</span>\n      <span class=\"n\">version</span><span class=\"o\">=</span><span class=\"s1\">&#39;0.1&#39;</span><span class=\"p\">,</span>\n      <span class=\"n\">packages</span><span class=\"o\">=</span><span class=\"p\">[</span><span class=\"s1\">&#39;pyhello&#39;</span><span class=\"p\">],</span>\n      <span class=\"n\">entry_points</span><span class=\"o\">=</span><span class=\"p\">{</span>\n          <span class=\"s1\">&#39;console_scripts&#39;</span><span class=\"p\">:</span> <span class=\"p\">[</span><span class=\"s1\">&#39;pyhello=pyhello.main:main&#39;</span><span class=\"p\">]})</span>\n</pre></div>\n\n</div>\n\n<p>El contenido de <code>pyhello/main.py</code>:</p>\n\n<div class=\"brush: python\">\n <div class=\"highlight\">\n  <pre><span></span><span class=\"k\">def</span> <span class=\"nf\">main</span><span class=\"p\">():</span>\n    <span class=\"k\">print</span> <span class=\"s2\">\"Hello from pyhello!\"</span>\n</pre></div>\n\n</div>\n\n<p>Después crea una distribución de fuentes con el comando estándar:</p>\n\n<div class=\"brush: console\">\n <div class=\"highlight\">\n  <pre><span></span><span class=\"go\">python setup.py sdist</span>\n</pre></div>\n\n</div>\n\n<p>Esto crea un lanzamiento llamado <code>pyhello-0.1.tar.gz</code> bajo el directorio <code>dist</code>.</p>\n\n<h2 id=\"servir-lanzamientos-por-http\">Servir lanzamientos por HTTP</h2>\n\n<p>Crea un directorio <code>releases</code> bajo <code>~/Sites</code>. Copia el fichero <code>dist/pyhello-0.1.tar.gz</code> allá.</p>\n\n<p>Crea un fichero de configuración para Apache en <code>/etc/apache2/users/YOUR_USERNAME.conf</code></p>\n\n<p>El contenido de <code>YOUR_USERNAME.conf</code>:</p>\n\n<div class=\"brush: apacheconf\">\n <div class=\"highlight\">\n  <pre><span></span><span class=\"nt\">&lt;Directory</span> <span class=\"s\">\"/Users/YOUR_USERNAME/Sites/\"</span><span class=\"nt\">&gt;</span>\n    <span class=\"nb\">Options</span> Indexes Multiviews\n    <span class=\"nb\">AllowOverride</span> AuthConfig Limit\n    <span class=\"nb\">Order</span> allow,deny\n    <span class=\"nb\">Allow</span> from <span class=\"k\">all</span>\n<span class=\"nt\">&lt;/Directory&gt;</span>\n</pre></div>\n\n</div>\n\n<p>Para lanzar Apache sólo durante esta sesión de la máquina:</p>\n\n<div class=\"brush: console\">\n <div class=\"highlight\">\n  <pre><span></span><span class=\"gp\">$</span> sudo apachectl start\n</pre></div>\n\n</div>\n\n<p>Para lanzar Apache automáticamente cada vez que se inicia la máquina:</p>\n\n<div class=\"brush: console\">\n <div class=\"highlight\">\n  <pre><span></span><span class=\"gp\">$</span> sudo launchctl load -w /System/Library/LaunchDaemons/org.apache.httpd.plist\n</pre></div>\n\n</div>\n\n<h2 id=\"crear-un-fichero-portfile\">Crear un fichero Portfile</h2>\n\n<p>El contenido de un fichero Portfile para un proyecto de Python normal (basado en un <code>setup.py</code>) es:</p>\n\n<pre><code># -*- coding: utf-8; mode: tcl; tab-width: 4; truncate-lines: t; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:et:sw=4:ts=4:sts=4\n# $Id$\n\nPortSystem 1.0\nPortGroup python 1.0\n\nname                py-pyhello\nversion             0.1\n\ncategories-append   devel\nlicense             BSD\nmaintainers         your.mail.provider.com:your.mail.name\ndescription         An example Python app\nlong_description    Pyhello is an example Python app, distributed over \\\n                    local Macports\n\nplatforms           darwin\nsupported_archs     noarch\n\nhomepage            http://your.local.machine/~YOUR_USERNAME/\nmaster_sites        http://your.local.machine/~YOUR_USERNAME/releases/\ndistname            pyhello-${version}\n\npython.versions     26 27\n\nchecksums           rmd160 b8a9e7e5db29d407db95310ee95e7048d6fa1cdd \\\n                    sha256 cd8693792f5e6632c0c7efd287b5153571173cc3a26f98c2cead7af6a0445b2b</code></pre>\n\n<p><strong>Aclaraciones</strong>:</p>\n\n<ul>\n <li>\n  <p><code>PortGroup</code> para python configura los comandos de <code>build</code> e <code>install</code>;  también existen grupos para <code>haskell</code> y otros.</p></li>\n <li>\n  <p>el nombre del paquete es manipulado para generar un paquete por cada versión  listada en <code>python.versions</code>. En este ejemplo, se generarían <code>py26-pyhello</code> y  <code>py27-pyhello</code>.</p></li>\n <li>\n  <p>la convención para el campo <code>maintainers</code> es <code>gmail.com:user</code> para  <code>user@gmail.com</code></p></li>\n <li>\n  <p>para generar los digests del lanzamiento con los siguientes comandos:</p></li></ul>\n\n<div class=\"brush: console\">\n <div class=\"highlight\">\n  <pre><span></span><span class=\"gp\">$</span> openssl sha256 dist/pyhello-0.1.tar.gz\n<span class=\"gp\">$</span> openssl rmd160 dist/pyhello-0.1.tar.gz\n</pre></div>\n\n</div>\n\n<h2 id=\"servir-portfiles-por-rsync\">Servir Portfiles por rsync</h2>\n\n<p>Crea un directorio <code>ports</code> bajo <code>~/Sites</code>, y los siguentes subdirectorios en él:</p>\n\n<div class=\"brush: console\">\n <div class=\"highlight\">\n  <pre><span></span><span class=\"go\">.</span>\n<span class=\"go\">└── python</span>\n<span class=\"go\">    └── pyhello</span>\n<span class=\"go\">        └── Portfile</span>\n</pre></div>\n\n</div>\n\n<p>Copia el fichero Portfile a su ubicación mostrada y ejecuta el siguiente comando en el directorio <code>ports</code>:</p>\n\n<div class=\"brush: console\">\n <div class=\"highlight\">\n  <pre><span></span><span class=\"gp\">$</span> portindex\n<span class=\"go\">Creating port index in ...</span>\n<span class=\"go\">Adding port python/pyhello</span>\n<span class=\"go\">Adding subport py26-pyhello</span>\n<span class=\"go\">Adding subport py27-pyhello</span>\n\n<span class=\"go\">Total number of ports parsed:\t3</span>\n<span class=\"go\">Ports successfully parsed:\t3</span>\n<span class=\"go\">Ports failed:\t\t\t0</span>\n<span class=\"go\">Up-to-date ports skipped:\t0</span>\n</pre></div>\n\n</div>\n\n<p>Aunque rsync viene instalado por defecto, usaremos la versión instalada con Macports en lo siguiente. La versión por defecto está en <code>/usr/bin</code>.</p>\n\n<p>Crear un fichero para <code>launchctl</code> en <code>/Library/LaunchDaemons/name.YOUR_USERNAME.rsync.plist</code></p>\n\n<p>El contenido de <code>rsync.plit</code>:</p>\n\n<div class=\"brush: xml\">\n <div class=\"highlight\">\n  <pre><span></span> <span class=\"cp\">&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;</span>\n <span class=\"cp\">&lt;!DOCTYPE plist PUBLIC \"-//Apple Computer//DTD PLIST 1.0//EN\" \"http://www.apple.com/DTDs/PropertyList-1.0.dtd\"&gt;</span>\n <span class=\"nt\">&lt;plist</span> <span class=\"na\">version=</span><span class=\"s\">\"1.0\"</span><span class=\"nt\">&gt;</span>\n <span class=\"nt\">&lt;dict&gt;</span>\n        <span class=\"nt\">&lt;key&gt;</span>Disabled<span class=\"nt\">&lt;/key&gt;</span>\n        <span class=\"nt\">&lt;false/&gt;</span>\n        <span class=\"nt\">&lt;key&gt;</span>Label<span class=\"nt\">&lt;/key&gt;</span>\n        <span class=\"nt\">&lt;string&gt;</span>name.YOUR_USERNAME.rsync<span class=\"nt\">&lt;/string&gt;</span>\n        <span class=\"nt\">&lt;key&gt;</span>Program<span class=\"nt\">&lt;/key&gt;</span>\n        <span class=\"nt\">&lt;string&gt;</span>/opt/local/bin/rsync<span class=\"nt\">&lt;/string&gt;</span>\n        <span class=\"nt\">&lt;key&gt;</span>ProgramArguments<span class=\"nt\">&lt;/key&gt;</span>\n        <span class=\"nt\">&lt;array&gt;</span>\n                <span class=\"nt\">&lt;string&gt;</span>/opt/local/bin/rsync<span class=\"nt\">&lt;/string&gt;</span>\n                <span class=\"nt\">&lt;string&gt;</span>--daemon<span class=\"nt\">&lt;/string&gt;</span>\n                <span class=\"nt\">&lt;string&gt;</span>--config=/opt/local/etc/rsyncd.conf<span class=\"nt\">&lt;/string&gt;</span>\n        <span class=\"nt\">&lt;/array&gt;</span>\n        <span class=\"nt\">&lt;key&gt;</span>inetdCompatibility<span class=\"nt\">&lt;/key&gt;</span>\n        <span class=\"nt\">&lt;dict&gt;</span>\n                <span class=\"nt\">&lt;key&gt;</span>Wait<span class=\"nt\">&lt;/key&gt;</span>\n                <span class=\"nt\">&lt;false/&gt;</span>\n        <span class=\"nt\">&lt;/dict&gt;</span>\n        <span class=\"nt\">&lt;key&gt;</span>Sockets<span class=\"nt\">&lt;/key&gt;</span>\n        <span class=\"nt\">&lt;dict&gt;</span>\n            <span class=\"nt\">&lt;key&gt;</span>Listeners<span class=\"nt\">&lt;/key&gt;</span>\n            <span class=\"nt\">&lt;dict&gt;</span>\n                <span class=\"nt\">&lt;key&gt;</span>SockServiceName<span class=\"nt\">&lt;/key&gt;</span>\n                <span class=\"nt\">&lt;string&gt;</span>rsync<span class=\"nt\">&lt;/string&gt;</span>\n                <span class=\"nt\">&lt;key&gt;</span>SockType<span class=\"nt\">&lt;/key&gt;</span>\n                <span class=\"nt\">&lt;string&gt;</span>stream<span class=\"nt\">&lt;/string&gt;</span>\n            <span class=\"nt\">&lt;/dict&gt;</span>\n        <span class=\"nt\">&lt;/dict&gt;</span>\n <span class=\"nt\">&lt;/dict&gt;</span>\n <span class=\"nt\">&lt;/plist&gt;</span>\n</pre></div>\n\n</div>\n\n<p>El contenido de <code>/opt/local/etc/rsyncd.conf</code>:</p>\n\n<div class=\"brush: ini\">\n <div class=\"highlight\">\n  <pre><span></span><span class=\"k\">[ports]</span>\n\n<span class=\"na\">path</span><span class=\"o\">=</span><span class=\"s\">/Users/YOUR_USERNAME/Sites/ports</span>\n<span class=\"na\">log file</span><span class=\"o\">=</span><span class=\"s\">/opt/local/var/log/rsyncd.log</span>\n<span class=\"na\">pid file</span><span class=\"o\">=</span><span class=\"s\">/opt/local/var/run/rsyncd.pid</span>\n<span class=\"na\">read only</span><span class=\"o\">=</span><span class=\"s\">true</span>\n</pre></div>\n\n</div>\n\n<p>Añadir rsync a <code>launchctl</code>:</p>\n\n<div class=\"brush: console\">\n <div class=\"highlight\">\n  <pre><span></span><span class=\"gp\">$</span> sudo launchctl load -w /Library/LaunchDaemons/name.YOUR_USERNAME.rsync.plist\n</pre></div>\n\n</div>\n\n<p>Comprueba que sólo se pueden listar los ports y nada más del sistema de fichero:</p>\n\n<div class=\"brush: console\">\n <div class=\"highlight\">\n  <pre><span></span><span class=\"gp\">$</span> rsync -axv rsync://localhost/\n<span class=\"gp\">$</span> rsync -axv rsync://localhost/ports/\n</pre></div>\n\n</div>\n\n<h2 id=\"configurar-macports\">Configurar Macports</h2>\n\n<p>Configura Macports en todas las máquinas que deban poder acceder a los nuevos paquetes. El nuevo repositorio debe ir antes del repositorio por defecto para evitar conflictos de nombres.</p>\n\n<pre><code>rsync://localhost/ports/\nrsync://rsync.macports.org/release/ports/ [default]</code></pre>\n\n<p>Comprueba desde otras máquinas que se pueden encontrar los nuevos paquetes:</p>\n\n<div class=\"brush: console\">\n <div class=\"highlight\">\n  <pre><span></span><span class=\"gp\">$</span> port search pyhello\n<span class=\"go\">py-pyhello @0.1 (python, devel)</span>\n<span class=\"go\">    An example Python app</span>\n\n<span class=\"go\">py26-pyhello @0.1 (python, devel)</span>\n<span class=\"go\">    An example Python app</span>\n\n<span class=\"go\">py27-pyhello @0.1 (python, devel)</span>\n<span class=\"go\">    An example Python app</span>\n</pre></div>\n\n</div>\n\n<p>Después de instalar el nuevo paquete, sus comandos están a nuestra disposición:</p>\n\n<div class=\"brush: console\">\n <div class=\"highlight\">\n  <pre><span></span><span class=\"gp\">$</span> sudo port install py27-pyhello\n<span class=\"gp\">$</span> pyhello\n<span class=\"go\">Hello from pyhello!</span>\n</pre></div>\n\n</div>")) ((? . 9) f post (u . "Instalar Python 2.7 y NumPy sobre RedHat 6") (? . 9) 1535126483 (p+ #"/Users/luis/Documents/code/logc.github.io/blog/2013/12/04/instalar-python-2-7-y-numpy-sobre-redhat-6/index.html" . unix) (u . "/blog/2013/12/04/instalar-python-2-7-y-numpy-sobre-redhat-6/") (u . "2013-12-04T11:44:57Z+0100") (? . 15) (? . 21) (c (u . "python")) (u . "\n<p>RedHat y centOS tienen la fastidiosa dependencia de su gestor de paquetes, yum, con la versión 2.6 de Python desde tiempos inmemoriales. Lo que en tecnología son unos seis o siete años.</p>\n\n<p>Instalar Python 2.7 no es posible con los repositorios instalados por defecto, y si tienes la mala idea de instalar un repositorio donde sí esté y meterlo como paquete que supedita al python por defecto, te acabas de cargar yum (y la posibilidad más sencilla de deshacer tus cambios).</p>\n\n<p>La mejor manera, pese a lo que pueda parecer, es <strong>instalar desde fuentes</strong>, haciendo lo que se conoce como &ldquo;altinstall&rdquo; (instalación alternativa). Esto crea ejecutables llamados <code>python2.7</code> bajo <code>/usr/local/bin</code>, que <strong>no sobreescriben</strong> el comando <code>python</code> normal del sistema; éste sigue apuntando a un ejecutable bajo <code>/usr/bin</code>.</p>\n\n<div class=\"brush: console\">\n <div class=\"highlight\">\n  <pre><span></span><span class=\"gp\">$</span> wget http://www.python.org/ftp/python/2.7.6/Python-2.7.6.tgz\n<span class=\"gp\">$</span> tar xvfz Python-2.7.6.tgz\n<span class=\"gp\">$</span> <span class=\"nb\">cd</span> Python-2.7.6\n<span class=\"gp\">$</span> ./configure\n<span class=\"gp\">$</span> make\n<span class=\"gp\">$</span> sudo make altinstall\n</pre></div>\n\n</div>\n\n<p>Además de esto, es recomendable instalar <strong>un <code>easy_install</code> alternativo también</strong>, ya que, si no, todas las librerías de python se instalarán para la 2.6 y no para la 2.7.</p>\n\n<div class=\"brush: console\">\n <div class=\"highlight\">\n  <pre><span></span><span class=\"gp\">$</span> wget http://pypi.python.org/packages/2.7/s/setuptools/setuptools-0.6c11-py2.7.egg\n<span class=\"gp\">$</span> sudo -i\n<span class=\"gp\">#</span> <span class=\"nb\">export</span> <span class=\"nv\">PATH</span><span class=\"o\">=</span><span class=\"nv\">$PATH</span>:/usr/local/bin\n<span class=\"gp\">#</span> sh setuptools-0.6c11-py2.7.egg\n<span class=\"gp\">#</span> <span class=\"nb\">exit</span>\n<span class=\"gp\">$</span> sudo rm /usr/local/bin/easy_install <span class=\"c1\">## remove the symlink that shadows the system easy_install</span>\n<span class=\"gp\">$</span> <span class=\"c1\"># You may now try the easy_install for 2.7 with e.g.:</span>\n<span class=\"gp\">$</span> sudo /usr/local/bin/easy_install-2.7 numpy\n</pre></div>\n\n</div>\n\n<p>Este post es una combinación de <a href=\"http://stackoverflow.com/questions/4149361/on-linux-suse-or-redhat-how-do-i-load-python-2-7\">dos respuestas en Stack Overflow</a>, y mi propia experiencia con este mismo problema.</p>") #f (u . "\n<p>RedHat y centOS tienen la fastidiosa dependencia de su gestor de paquetes, yum, con la versión 2.6 de Python desde tiempos inmemoriales. Lo que en tecnología son unos seis o siete años.</p>\n\n<p>Instalar Python 2.7 no es posible con los repositorios instalados por defecto, y si tienes la mala idea de instalar un repositorio donde sí esté y meterlo como paquete que supedita al python por defecto, te acabas de cargar yum (y la posibilidad más sencilla de deshacer tus cambios).</p>\n\n<p>La mejor manera, pese a lo que pueda parecer, es <strong>instalar desde fuentes</strong>, haciendo lo que se conoce como &ldquo;altinstall&rdquo; (instalación alternativa). Esto crea ejecutables llamados <code>python2.7</code> bajo <code>/usr/local/bin</code>, que <strong>no sobreescriben</strong> el comando <code>python</code> normal del sistema; éste sigue apuntando a un ejecutable bajo <code>/usr/bin</code>.</p>\n\n<div class=\"brush: console\">\n <div class=\"highlight\">\n  <pre><span></span><span class=\"gp\">$</span> wget http://www.python.org/ftp/python/2.7.6/Python-2.7.6.tgz\n<span class=\"gp\">$</span> tar xvfz Python-2.7.6.tgz\n<span class=\"gp\">$</span> <span class=\"nb\">cd</span> Python-2.7.6\n<span class=\"gp\">$</span> ./configure\n<span class=\"gp\">$</span> make\n<span class=\"gp\">$</span> sudo make altinstall\n</pre></div>\n\n</div>\n\n<p>Además de esto, es recomendable instalar <strong>un <code>easy_install</code> alternativo también</strong>, ya que, si no, todas las librerías de python se instalarán para la 2.6 y no para la 2.7.</p>\n\n<div class=\"brush: console\">\n <div class=\"highlight\">\n  <pre><span></span><span class=\"gp\">$</span> wget http://pypi.python.org/packages/2.7/s/setuptools/setuptools-0.6c11-py2.7.egg\n<span class=\"gp\">$</span> sudo -i\n<span class=\"gp\">#</span> <span class=\"nb\">export</span> <span class=\"nv\">PATH</span><span class=\"o\">=</span><span class=\"nv\">$PATH</span>:/usr/local/bin\n<span class=\"gp\">#</span> sh setuptools-0.6c11-py2.7.egg\n<span class=\"gp\">#</span> <span class=\"nb\">exit</span>\n<span class=\"gp\">$</span> sudo rm /usr/local/bin/easy_install <span class=\"c1\">## remove the symlink that shadows the system easy_install</span>\n<span class=\"gp\">$</span> <span class=\"c1\"># You may now try the easy_install for 2.7 with e.g.:</span>\n<span class=\"gp\">$</span> sudo /usr/local/bin/easy_install-2.7 numpy\n</pre></div>\n\n</div>\n\n<p>Este post es una combinación de <a href=\"http://stackoverflow.com/questions/4149361/on-linux-suse-or-redhat-how-do-i-load-python-2-7\">dos respuestas en Stack Overflow</a>, y mi propia experiencia con este mismo problema.</p>")) ((? . 10) f post (u . "Wordcount in C++") (? . 10) 1535126483 (p+ #"/Users/luis/Documents/code/logc.github.io/blog/2014/01/21/wordcount-in-c/index.html" . unix) (u . "/blog/2014/01/21/wordcount-in-c/") (u . "2014-01-21T14:52:26Z+0100") (? . 20) (? . 6) (c (u . "C++")) (u . "\n<p>This is the standard example for MapReduce applications, counting the words in a file. Note that this snippet is not threaded nor distributed. It is just a curiosity: how to implement the same in C++, using the STL to avoid having any <code>for</code> loop!</p>") #t (u . "\n<p>This is the standard example for MapReduce applications, counting the words in a file. Note that this snippet is not threaded nor distributed. It is just a curiosity: how to implement the same in C++, using the STL to avoid having any <code>for</code> loop!</p>\n<!-- more-->\n\n<div class=\"brush: c++\">\n <div class=\"highlight\">\n  <pre><span></span><span class=\"cp\">#include</span> <span class=\"cpf\">&lt;fstream&gt;</span><span class=\"cp\"></span>\n<span class=\"cp\">#include</span> <span class=\"cpf\">&lt;iostream&gt;</span><span class=\"cp\"></span>\n<span class=\"cp\">#include</span> <span class=\"cpf\">&lt;numeric&gt;</span><span class=\"cp\"></span>\n<span class=\"cp\">#include</span> <span class=\"cpf\">&lt;sstream&gt;</span><span class=\"cp\"></span>\n<span class=\"cp\">#include</span> <span class=\"cpf\">&lt;string&gt;</span><span class=\"cp\"></span>\n<span class=\"cp\">#include</span> <span class=\"cpf\">&lt;vector&gt;</span><span class=\"cp\"></span>\n\n<span class=\"k\">using</span> <span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">pair</span><span class=\"p\">;</span>\n<span class=\"k\">using</span> <span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">string</span><span class=\"p\">;</span>\n<span class=\"k\">using</span> <span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">vector</span><span class=\"p\">;</span>\n<span class=\"k\">using</span> <span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">istringstream</span><span class=\"p\">;</span>\n<span class=\"k\">using</span> <span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">istream_iterator</span><span class=\"p\">;</span>\n\n\n<span class=\"n\">vector</span><span class=\"o\">&lt;</span><span class=\"n\">string</span><span class=\"o\">&gt;</span> <span class=\"n\">split_at_whitespace</span><span class=\"p\">(</span><span class=\"n\">string</span> <span class=\"n\">line</span><span class=\"p\">)</span>\n<span class=\"p\">{</span>\n    <span class=\"n\">istringstream</span> <span class=\"n\">iss</span><span class=\"p\">(</span><span class=\"n\">line</span><span class=\"p\">);</span>\n    <span class=\"n\">vector</span><span class=\"o\">&lt;</span><span class=\"n\">string</span><span class=\"o\">&gt;</span> <span class=\"n\">tokens</span><span class=\"p\">{</span>\n        <span class=\"n\">istream_iterator</span><span class=\"o\">&lt;</span><span class=\"n\">string</span><span class=\"o\">&gt;</span><span class=\"p\">{</span><span class=\"n\">iss</span><span class=\"p\">},</span>\n        <span class=\"n\">istream_iterator</span><span class=\"o\">&lt;</span><span class=\"n\">string</span><span class=\"o\">&gt;</span><span class=\"p\">{}};</span>\n    <span class=\"k\">return</span> <span class=\"n\">tokens</span><span class=\"p\">;</span>\n<span class=\"p\">}</span>\n\n<span class=\"n\">vector</span><span class=\"o\">&lt;</span> <span class=\"n\">pair</span><span class=\"o\">&lt;</span><span class=\"n\">string</span><span class=\"p\">,</span> <span class=\"kt\">int</span><span class=\"o\">&gt;</span> <span class=\"o\">&gt;</span> <span class=\"n\">map</span><span class=\"p\">(</span><span class=\"n\">string</span> <span class=\"n\">line</span><span class=\"p\">)</span>\n<span class=\"p\">{</span>\n    <span class=\"n\">vector</span><span class=\"o\">&lt;</span><span class=\"n\">string</span><span class=\"o\">&gt;</span> <span class=\"n\">tokens</span> <span class=\"o\">=</span> <span class=\"n\">split_at_whitespace</span><span class=\"p\">(</span><span class=\"n\">line</span><span class=\"p\">);</span>\n    <span class=\"n\">vector</span><span class=\"o\">&lt;</span> <span class=\"n\">pair</span><span class=\"o\">&lt;</span><span class=\"n\">string</span><span class=\"p\">,</span> <span class=\"kt\">int</span><span class=\"o\">&gt;</span> <span class=\"o\">&gt;</span> <span class=\"n\">current_outputs</span><span class=\"p\">(</span><span class=\"n\">tokens</span><span class=\"p\">.</span><span class=\"n\">size</span><span class=\"p\">());</span>\n    <span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">transform</span><span class=\"p\">(</span>\n        <span class=\"n\">tokens</span><span class=\"p\">.</span><span class=\"n\">begin</span><span class=\"p\">(),</span> <span class=\"n\">tokens</span><span class=\"p\">.</span><span class=\"n\">end</span><span class=\"p\">(),</span> <span class=\"n\">current_outputs</span><span class=\"p\">.</span><span class=\"n\">begin</span><span class=\"p\">(),</span>\n        <span class=\"p\">[]</span> <span class=\"p\">(</span><span class=\"k\">const</span> <span class=\"n\">string</span> <span class=\"n\">output</span><span class=\"p\">)</span> <span class=\"p\">{</span>\n            <span class=\"k\">return</span> <span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">make_pair</span><span class=\"p\">(</span><span class=\"n\">output</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">);</span>\n        <span class=\"p\">});</span>\n    <span class=\"k\">return</span> <span class=\"n\">current_outputs</span><span class=\"p\">;</span>\n<span class=\"p\">}</span>\n\n<span class=\"kt\">int</span> <span class=\"n\">reduce</span><span class=\"p\">(</span><span class=\"n\">vector</span><span class=\"o\">&lt;</span> <span class=\"n\">pair</span><span class=\"o\">&lt;</span><span class=\"n\">string</span><span class=\"p\">,</span> <span class=\"kt\">int</span><span class=\"o\">&gt;</span> <span class=\"o\">&gt;</span> <span class=\"n\">outputs</span><span class=\"p\">)</span>\n<span class=\"p\">{</span>\n    <span class=\"k\">return</span> <span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">accumulate</span><span class=\"p\">(</span>\n        <span class=\"n\">outputs</span><span class=\"p\">.</span><span class=\"n\">begin</span><span class=\"p\">(),</span> <span class=\"n\">outputs</span><span class=\"p\">.</span><span class=\"n\">end</span><span class=\"p\">(),</span> <span class=\"mf\">0.0</span><span class=\"p\">,</span>\n        <span class=\"p\">[]</span> <span class=\"p\">(</span><span class=\"kt\">int</span> <span class=\"n\">sum</span><span class=\"p\">,</span> <span class=\"k\">const</span> <span class=\"n\">pair</span><span class=\"o\">&lt;</span><span class=\"n\">string</span><span class=\"p\">,</span> <span class=\"kt\">int</span><span class=\"o\">&gt;</span> <span class=\"n\">output</span><span class=\"p\">)</span> <span class=\"p\">{</span>\n                <span class=\"k\">return</span> <span class=\"n\">sum</span> <span class=\"o\">+</span> <span class=\"n\">output</span><span class=\"p\">.</span><span class=\"n\">second</span><span class=\"p\">;</span>\n            <span class=\"p\">});</span>\n<span class=\"p\">}</span>\n\n<span class=\"kt\">int</span> <span class=\"n\">main</span><span class=\"p\">(</span><span class=\"kt\">int</span> <span class=\"n\">argc</span><span class=\"p\">,</span> <span class=\"k\">const</span> <span class=\"kt\">char</span> <span class=\"o\">*</span><span class=\"n\">argv</span><span class=\"p\">[])</span>\n<span class=\"p\">{</span>\n    <span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"n\">argc</span> <span class=\"o\">&lt;</span> <span class=\"mi\">2</span><span class=\"p\">)</span> <span class=\"p\">{</span>\n        <span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">cout</span> <span class=\"o\">&lt;&lt;</span> <span class=\"s\">\"Usage: \"</span> <span class=\"o\">&lt;&lt;</span> <span class=\"n\">argv</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span> <span class=\"o\">&lt;&lt;</span> <span class=\"s\">\" infile\"</span> <span class=\"o\">&lt;&lt;</span> <span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">endl</span><span class=\"p\">;</span>\n        <span class=\"k\">return</span> <span class=\"mi\">1</span><span class=\"p\">;</span>\n    <span class=\"p\">}</span>\n\n    <span class=\"n\">string</span> <span class=\"n\">filename</span> <span class=\"o\">=</span> <span class=\"n\">argv</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">];</span>\n    <span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">ifstream</span> <span class=\"n\">infile</span><span class=\"p\">(</span><span class=\"n\">filename</span><span class=\"p\">);</span>\n    <span class=\"n\">string</span> <span class=\"n\">line</span><span class=\"p\">;</span>\n    <span class=\"n\">vector</span><span class=\"o\">&lt;</span> <span class=\"n\">pair</span><span class=\"o\">&lt;</span><span class=\"n\">string</span><span class=\"p\">,</span> <span class=\"kt\">int</span><span class=\"o\">&gt;</span> <span class=\"o\">&gt;</span> <span class=\"n\">occurences</span><span class=\"p\">;</span>\n    <span class=\"k\">while</span> <span class=\"p\">(</span><span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">getline</span><span class=\"p\">(</span><span class=\"n\">infile</span><span class=\"p\">,</span> <span class=\"n\">line</span><span class=\"p\">))</span> <span class=\"p\">{</span>\n        <span class=\"k\">auto</span> <span class=\"n\">line_occurences</span> <span class=\"o\">=</span> <span class=\"n\">map</span><span class=\"p\">(</span><span class=\"n\">line</span><span class=\"p\">);</span>\n        <span class=\"n\">occurences</span><span class=\"p\">.</span><span class=\"n\">insert</span><span class=\"p\">(</span>\n            <span class=\"n\">occurences</span><span class=\"p\">.</span><span class=\"n\">end</span><span class=\"p\">(),</span> <span class=\"n\">line_occurences</span><span class=\"p\">.</span><span class=\"n\">begin</span><span class=\"p\">(),</span> <span class=\"n\">line_occurences</span><span class=\"p\">.</span><span class=\"n\">end</span><span class=\"p\">());</span>\n    <span class=\"p\">}</span>\n    <span class=\"kt\">int</span> <span class=\"n\">n</span> <span class=\"o\">=</span> <span class=\"n\">reduce</span><span class=\"p\">(</span><span class=\"n\">occurences</span><span class=\"p\">);</span>\n    <span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">cout</span> <span class=\"o\">&lt;&lt;</span> <span class=\"s\">\"File \"</span> <span class=\"o\">&lt;&lt;</span> <span class=\"n\">filename</span> <span class=\"o\">&lt;&lt;</span> <span class=\"s\">\" holds \"</span> <span class=\"o\">&lt;&lt;</span> <span class=\"n\">n</span> <span class=\"o\">&lt;&lt;</span> <span class=\"s\">\" words\"</span> <span class=\"o\">&lt;&lt;</span> <span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">endl</span><span class=\"p\">;</span>\n    <span class=\"k\">return</span> <span class=\"mi\">0</span><span class=\"p\">;</span>\n<span class=\"p\">}</span>\n</pre></div>\n\n</div>\n\n<p>Compile and run:</p>\n\n<div class=\"brush: console\">\n <div class=\"highlight\">\n  <pre><span></span><span class=\"gp\">$</span> cat <span class=\"s\">&lt;&lt; EOF &gt; sample.txt</span>\n<span class=\"gp\">&gt;</span><span class=\"s\"> This is a first line</span>\n<span class=\"gp\">&gt;</span><span class=\"s\"> This is a second line</span>\n<span class=\"gp\">&gt;</span><span class=\"s\"> EOF</span>\n\n<span class=\"gp\">$</span> c++ main.cpp -o wordcount -std<span class=\"o\">=</span>c++11 <span class=\"o\">&amp;&amp;</span> ./wordcount sample.txt\n<span class=\"go\">File sample.txt holds 10 words</span>\n</pre></div>\n\n</div>")) ((? . 11) f post (u . "Some Git aliases") (? . 11) 1535126483 (p+ #"/Users/luis/Documents/code/logc.github.io/blog/2017/08/15/some-git-aliases/index.html" . unix) (u . "/blog/2017/08/15/some-git-aliases/") (u . "2017-08-15T18:18:11") (? . 22) (? . 19) (c (u . "git")) (u . "\n<p>Here are some of the Git alias configurations that I use. My philosophy in writing them was to keep them descriptive, and <em>not to keep them easy to type</em>, following the approach in <a href=\"http://blog.wittchen.biz.pl/my-approach-to-git-aliases/\">this blog post</a>. In order to keep my typing short, I use the <a href=\"http://fishshell.com\">fish shell</a>.</p>\n\n<pre><code>[alias]\n\tamend = commit --amend\n\tdiscard = checkout --\n\tdocommit = commit --verbose --all\n\thist = log --color --pretty=format:\\\"%C(yellow)%h%C(reset) %s%C(bold red)%d%C(reset) %C(green)%ad%C(reset) %C(blue)[%an]%C(reset)\\\" --relative-date --decorate\n\tlastedit = log --pretty=format: --name-only -n 1\n\tlogshort = log --oneline -n 10\n    lsmodified = diff --name-only head\n\tmkbranch = checkout -b\n\trmbranch = branch -d</code></pre>\n\n<p>The aliases <code>amend</code> and <code>discard</code> are pretty self-explanatory. <code>docommit</code> reflects my own preferences when finishing a commit: just commit everything that is currently modified and add a diff under the commit message, so that I can review what I actually modified everywhere. <code>hist</code> is something I don&rsquo;t use very much; I copied it from somewhere and I keep it around to avoid going to a GUI when I need to review history in-depth.</p>\n\n<p><code>lastedit</code> lists which files were edited in the last commit. I find it useful to just open them again in an editor:</p>\n\n<pre><code>$ vim (git lastedit)</code></pre>\n\n<p><code>logshort</code> is probably the alias I use the most. It just gives me an idea of what was going on in a branch, without defaulting to show me all history since the beginning of time. <code>lsmodified</code> is a recent addition. It lists all files modified but not commited. It is intended to be used together with other aliases:</p>\n\n<pre><code>$ git discard (git lsmodified)</code></pre>\n\n<p><code>mkbranch</code> and <code>rmbranch</code> are also quite useful to me. I tend to see Git as a file system: sometimes I start to type <code>ls -l</code> when I actually need <code>git\nstatus</code>. In that mindset, I tend to identify branches with directories, and therefore creating and deleting them as if they were directories makes sense.</p>") #f (u . "\n<p>Here are some of the Git alias configurations that I use. My philosophy in writing them was to keep them descriptive, and <em>not to keep them easy to type</em>, following the approach in <a href=\"http://blog.wittchen.biz.pl/my-approach-to-git-aliases/\">this blog post</a>. In order to keep my typing short, I use the <a href=\"http://fishshell.com\">fish shell</a>.</p>\n\n<pre><code>[alias]\n\tamend = commit --amend\n\tdiscard = checkout --\n\tdocommit = commit --verbose --all\n\thist = log --color --pretty=format:\\\"%C(yellow)%h%C(reset) %s%C(bold red)%d%C(reset) %C(green)%ad%C(reset) %C(blue)[%an]%C(reset)\\\" --relative-date --decorate\n\tlastedit = log --pretty=format: --name-only -n 1\n\tlogshort = log --oneline -n 10\n    lsmodified = diff --name-only head\n\tmkbranch = checkout -b\n\trmbranch = branch -d</code></pre>\n\n<p>The aliases <code>amend</code> and <code>discard</code> are pretty self-explanatory. <code>docommit</code> reflects my own preferences when finishing a commit: just commit everything that is currently modified and add a diff under the commit message, so that I can review what I actually modified everywhere. <code>hist</code> is something I don&rsquo;t use very much; I copied it from somewhere and I keep it around to avoid going to a GUI when I need to review history in-depth.</p>\n\n<p><code>lastedit</code> lists which files were edited in the last commit. I find it useful to just open them again in an editor:</p>\n\n<pre><code>$ vim (git lastedit)</code></pre>\n\n<p><code>logshort</code> is probably the alias I use the most. It just gives me an idea of what was going on in a branch, without defaulting to show me all history since the beginning of time. <code>lsmodified</code> is a recent addition. It lists all files modified but not commited. It is intended to be used together with other aliases:</p>\n\n<pre><code>$ git discard (git lsmodified)</code></pre>\n\n<p><code>mkbranch</code> and <code>rmbranch</code> are also quite useful to me. I tend to see Git as a file system: sometimes I start to type <code>ls -l</code> when I actually need <code>git\nstatus</code>. In that mindset, I tend to identify branches with directories, and therefore creating and deleting them as if they were directories makes sense.</p>")) ((? . 12) f post (u . "What to learn in a new programming language") (? . 12) 1535127058 (p+ #"/Users/luis/Documents/code/logc.github.io/blog/2018/08/24/what-to-learn-in-a-new-programming-language/index.html" . unix) (u . "/blog/2018/08/24/what-to-learn-in-a-new-programming-language/") (u . "2018-08-24T18:03:56") (? . 1) #f (c (u . "programming")) (u . "\n<p>This is a list of practical tasks that I learn in any language. Each point builds more or less on top of the previous ones.</p>\n\n<ul>\n <li>write a unittest</li>\n <li>read a configuration file</li>\n <li>parse command line arguments</li>\n <li>pass arguments to different functions</li>\n <li>logging</li>\n <li>write to a database</li>\n <li>run concurrent processes</li>\n <li>monitoring of a server process</li>\n <li>reporting/alerting</li>\n <li>create a GUI</li>\n <li>create a web interface</li>\n <li>create a REST interface</li>\n <li>create an installer/deployable app</li></ul>") #f (u . "\n<p>This is a list of practical tasks that I learn in any language. Each point builds more or less on top of the previous ones.</p>\n\n<ul>\n <li>write a unittest</li>\n <li>read a configuration file</li>\n <li>parse command line arguments</li>\n <li>pass arguments to different functions</li>\n <li>logging</li>\n <li>write to a database</li>\n <li>run concurrent processes</li>\n <li>monitoring of a server process</li>\n <li>reporting/alerting</li>\n <li>create a GUI</li>\n <li>create a web interface</li>\n <li>create a REST interface</li>\n <li>create an installer/deployable app</li></ul>")) ((? . 13) f post (u . "Ensime server crash because of transitive dependency") (? . 13) 1535126483 (p+ #"/Users/luis/Documents/code/logc.github.io/blog/2017/09/05/ensime-server-crash-because-of-transitive-dependency/index.html" . unix) (u . "/blog/2017/09/05/ensime-server-crash-because-of-transitive-dependency/") (u . "2017-09-05T15:47:32") (? . 18) (? . 14) (c (u . "scala") c (u . "emacs")) (u . "\n<p>The Scala layer for Spacemacs uses Ensime by default. There is an error that made me struggle for weeks: <a href=\"https://github.com/ensime/ensime-server/issues/825\">Bad source jar kills the server: ZipException: error in opening zip file</a></p>\n\n<p>The offending JAR was a transitive dependency of a project, and the solution offered on the issue was not clear for me.</p>\n\n<p>This problem is tricky if you previously loaded the project into an IDE: they download by default all transitive dependencies with sources and javadoc, and the ivy cache is shared by all projects in the same machine.</p>\n\n<p>Here is my solution, as found also on the issue, in case it helps others:</p>\n\n<ul>\n <li>determine which dependency is pulling the problem JAR with the <a href=\"https://github.com/jrudolph/sbt-dependency-graph\">sbt dependency  graph plugin</a> (note: the  command <code>whatDependsOn</code> only works in interactive mode)</li>\n <li>move away the current ivy cache folder <code>console\n$ mv ~/.ivy2/ ~/.ivy2_old</code></li>\n <li>(optional) create a new clone to have a known state <code>console\n$ git clone $repo ~/dev/ensime-$repo</code></li>\n <li>edit <code>build.sbt</code> to add an exclusion rule for the transitive dependency at the  line of the explicit dependency that needs it, e.g. <code>sbt\nlibraryDependencies ++= Seq(\n  \"com.company.notifications\" % \"notifications-schema\" exclude(\"org.json\", \"json\")\n)</code></li>\n <li>compile, go for a coffee while ivy downloads the internet :), then run ensime commands <code>console\n$ sbt compile\n$ sbt ensimeConfig ensimeConfigProject</code></li></ul>") #f (u . "\n<p>The Scala layer for Spacemacs uses Ensime by default. There is an error that made me struggle for weeks: <a href=\"https://github.com/ensime/ensime-server/issues/825\">Bad source jar kills the server: ZipException: error in opening zip file</a></p>\n\n<p>The offending JAR was a transitive dependency of a project, and the solution offered on the issue was not clear for me.</p>\n\n<p>This problem is tricky if you previously loaded the project into an IDE: they download by default all transitive dependencies with sources and javadoc, and the ivy cache is shared by all projects in the same machine.</p>\n\n<p>Here is my solution, as found also on the issue, in case it helps others:</p>\n\n<ul>\n <li>determine which dependency is pulling the problem JAR with the <a href=\"https://github.com/jrudolph/sbt-dependency-graph\">sbt dependency  graph plugin</a> (note: the  command <code>whatDependsOn</code> only works in interactive mode)</li>\n <li>move away the current ivy cache folder <code>console\n$ mv ~/.ivy2/ ~/.ivy2_old</code></li>\n <li>(optional) create a new clone to have a known state <code>console\n$ git clone $repo ~/dev/ensime-$repo</code></li>\n <li>edit <code>build.sbt</code> to add an exclusion rule for the transitive dependency at the  line of the explicit dependency that needs it, e.g. <code>sbt\nlibraryDependencies ++= Seq(\n  \"com.company.notifications\" % \"notifications-schema\" exclude(\"org.json\", \"json\")\n)</code></li>\n <li>compile, go for a coffee while ivy downloads the internet :), then run ensime commands <code>console\n$ sbt compile\n$ sbt ensimeConfig ensimeConfigProject</code></li></ul>")) ((? . 15) f post (u . "Unicode encodings") (? . 15) 1535126483 (p+ #"/Users/luis/Documents/code/logc.github.io/blog/2013/12/03/unicode-encodings/index.html" . unix) (u . "/blog/2013/12/03/unicode-encodings/") (u . "2013-12-03T13:46:19Z+0100") (? . 25) (? . 9) (c (u . "python")) (u . "\n<p>¡Por fin he entendido cuál es la diferencia entre Unicode y UTF&ndash;8! Y lo que es más importante, cómo se declaran correctamente <code>strings</code> en Unicode en Python.</p>\n\n<p>Unicode es <strong>la tabla de equivalencias</strong> entre caracteres de (casi) todos los lenguajes humanos, y un número asignado a ese caracter en concreto.</p>\n\n<p>UTF&ndash;8 es <strong>la manera de comprimir</strong> esos números en uno o dos bytes, en lugar de usar 4 bytes por caracter, aprovechando el hecho de que la mayoría de caracteres habituales están en los números bajos (menores de 128).</p>\n\n<p>Es decir, si el &ldquo;encodificador&rdquo; encuentra un número &lt; 128, deja ese número; si encuentra uno mayor, pero menor de X (donde X es un límite que no recuerdo), usa <strong>dos bytes</strong> para expresar este número. El &ldquo;decodificador&rdquo; entonces sabe que cada caracter menor de 128 está &ldquo;solo&rdquo;, mientras que si encuentra uno mayor, entonces debe leer también el siguiente byte para tener el número correcto con el que ir a la tabla Unicode y obtener el caracter adecuado.</p>\n\n<p>Se puede crear una cadena Unicode en Python usando una <code>u</code> delante de la cadena literal, pero esto no siempre es posible, como cuando se lee de un fichero. Para convertir entre distintas codificaciones existe la función <code>unicode</code>.</p>\n\n<p>La función <code>unicode</code> <strong>no utiliza UTF&ndash;8 por defecto</strong>, sino, absurdamente, ASCII. Por eso <em>sólo es equivalente a poner una <code>u</code> delante una cadena si se especifica que el <code>encoding</code> sea <code>'utf-8'</code></em>.</p>\n\n<div class=\"brush: python\">\n <div class=\"highlight\">\n  <pre><span></span><span class=\"n\">unicode_string</span> <span class=\"o\">=</span> <span class=\"sa\">u</span><span class=\"s2\">\"Años\"</span>\n\n<span class=\"n\">unicode_str</span> <span class=\"o\">=</span> <span class=\"nb\">unicode</span><span class=\"p\">(</span><span class=\"nb\">open</span><span class=\"p\">(</span><span class=\"s1\">&#39;some.txt&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;r&#39;</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">read</span><span class=\"p\">(),</span> <span class=\"n\">encoding</span><span class=\"o\">=</span><span class=\"s1\">&#39;utf-8&#39;</span><span class=\"p\">)</span>\n</pre></div>\n\n</div>") #f (u . "\n<p>¡Por fin he entendido cuál es la diferencia entre Unicode y UTF&ndash;8! Y lo que es más importante, cómo se declaran correctamente <code>strings</code> en Unicode en Python.</p>\n\n<p>Unicode es <strong>la tabla de equivalencias</strong> entre caracteres de (casi) todos los lenguajes humanos, y un número asignado a ese caracter en concreto.</p>\n\n<p>UTF&ndash;8 es <strong>la manera de comprimir</strong> esos números en uno o dos bytes, en lugar de usar 4 bytes por caracter, aprovechando el hecho de que la mayoría de caracteres habituales están en los números bajos (menores de 128).</p>\n\n<p>Es decir, si el &ldquo;encodificador&rdquo; encuentra un número &lt; 128, deja ese número; si encuentra uno mayor, pero menor de X (donde X es un límite que no recuerdo), usa <strong>dos bytes</strong> para expresar este número. El &ldquo;decodificador&rdquo; entonces sabe que cada caracter menor de 128 está &ldquo;solo&rdquo;, mientras que si encuentra uno mayor, entonces debe leer también el siguiente byte para tener el número correcto con el que ir a la tabla Unicode y obtener el caracter adecuado.</p>\n\n<p>Se puede crear una cadena Unicode en Python usando una <code>u</code> delante de la cadena literal, pero esto no siempre es posible, como cuando se lee de un fichero. Para convertir entre distintas codificaciones existe la función <code>unicode</code>.</p>\n\n<p>La función <code>unicode</code> <strong>no utiliza UTF&ndash;8 por defecto</strong>, sino, absurdamente, ASCII. Por eso <em>sólo es equivalente a poner una <code>u</code> delante una cadena si se especifica que el <code>encoding</code> sea <code>'utf-8'</code></em>.</p>\n\n<div class=\"brush: python\">\n <div class=\"highlight\">\n  <pre><span></span><span class=\"n\">unicode_string</span> <span class=\"o\">=</span> <span class=\"sa\">u</span><span class=\"s2\">\"Años\"</span>\n\n<span class=\"n\">unicode_str</span> <span class=\"o\">=</span> <span class=\"nb\">unicode</span><span class=\"p\">(</span><span class=\"nb\">open</span><span class=\"p\">(</span><span class=\"s1\">&#39;some.txt&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;r&#39;</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">read</span><span class=\"p\">(),</span> <span class=\"n\">encoding</span><span class=\"o\">=</span><span class=\"s1\">&#39;utf-8&#39;</span><span class=\"p\">)</span>\n</pre></div>\n\n</div>")) ((? . 16) f post (u . "Debug Scala with Spacemacs") (? . 16) 1535126483 (p+ #"/Users/luis/Documents/code/logc.github.io/blog/2018/05/14/debug-scala-with-spacemacs/index.html" . unix) (u . "/blog/2018/05/14/debug-scala-with-spacemacs/") (u . "2018-05-14T16:08:11") (? . 2) (? . 17) (c (u . "scala") c (u . "spacemacs")) (u . "\n<p>The <a href=\"http://ensime.github.io/editors/emacs/userguide/#debugging\">documentation about debugging in ENSIME</a> was a bit confusing to me. Here are my notes on how to start debugging an (sbt-based) Scala project from Emacs (Spacemacs):</p>\n\n<ol>\n <li>\n  <p>Launch the debugger from the sbt console first. Use the sbt-mode shell. I  don&rsquo;t really know if this works launching SBT on a terminal not running under  Emacs. Use <code>ensimeTestOnlyDebug</code> if you are running a test, otherwise use  <code>ensimeRunDebug</code> for an implementation class.</p>\n  <pre><code>&gt; ensimeTestOnlyDebug com.company.division.squad.project.package.TestClass\n...\nListening for transport dt_socket at address: 5005</code></pre></li>\n <li>\n  <p>Set a breakpoint in a source code line by moving your cursor to that line and  using <code>, d b</code></p></li>\n <li>\n  <p>Attach to the debugger by using <code>, d A</code>. The first time, you will need to  specify Host (<code>localhost</code>) and Port (the number in the <code>Listening for\n   transport ...</code> line above)</p></li>\n <li>\n  <p>When (if) the debugger hits the line where your breakpoint is set, the Emacs  cursor will jump to that position, and you can start using other debugging  commands (<code>, d n</code>, <code>, d i</code>, etc &hellip;)</p></li></ol>") #f (u . "\n<p>The <a href=\"http://ensime.github.io/editors/emacs/userguide/#debugging\">documentation about debugging in ENSIME</a> was a bit confusing to me. Here are my notes on how to start debugging an (sbt-based) Scala project from Emacs (Spacemacs):</p>\n\n<ol>\n <li>\n  <p>Launch the debugger from the sbt console first. Use the sbt-mode shell. I  don&rsquo;t really know if this works launching SBT on a terminal not running under  Emacs. Use <code>ensimeTestOnlyDebug</code> if you are running a test, otherwise use  <code>ensimeRunDebug</code> for an implementation class.</p>\n  <pre><code>&gt; ensimeTestOnlyDebug com.company.division.squad.project.package.TestClass\n...\nListening for transport dt_socket at address: 5005</code></pre></li>\n <li>\n  <p>Set a breakpoint in a source code line by moving your cursor to that line and  using <code>, d b</code></p></li>\n <li>\n  <p>Attach to the debugger by using <code>, d A</code>. The first time, you will need to  specify Host (<code>localhost</code>) and Port (the number in the <code>Listening for\n   transport ...</code> line above)</p></li>\n <li>\n  <p>When (if) the debugger hits the line where your breakpoint is set, the Emacs  cursor will jump to that position, and you can start using other debugging  commands (<code>, d n</code>, <code>, d i</code>, etc &hellip;)</p></li></ol>")) ((? . 18) f post (u . "Maven does not find JAVA_HOME in Fish shell") (? . 18) 1535126483 (p+ #"/Users/luis/Documents/code/logc.github.io/blog/2017/08/25/maven-does-not-find-java-home-in-fish-shell/index.html" . unix) (u . "/blog/2017/08/25/maven-does-not-find-java-home-in-fish-shell/") (u . "2017-08-25T14:37:39") (? . 19) (? . 13) (c (u . "fish") c (u . "maven") c (u . "java")) (u . "\n<p>After reinstalling <code>java</code> from <code>brew cask</code>, it could happen that Maven does not find anymore the JAVA_HOME. The error looks like this:</p>\n\n<div class=\"brush: console\">\n <div class=\"highlight\">\n  <pre><span></span><span class=\"gp\">$</span> mvn clean install\n<span class=\"go\">The JAVA_HOME environment variable is not defined correctly</span>\n<span class=\"go\">This environment variable is needed to run this program</span>\n<span class=\"go\">NB: JAVA_HOME should point to a JDK not a JR</span>\n</pre></div>\n\n</div>\n\n<p>In Fish shell, on Mac OS X, the solution is to set the variable in universal mode:</p>\n\n<div class=\"brush: console\">\n <div class=\"highlight\">\n  <pre><span></span><span class=\"gp\">$</span> <span class=\"nb\">set</span> -U JAVA_HOME <span class=\"o\">(</span>/usr/libexec/java_home<span class=\"o\">)</span>\n</pre></div>\n\n</div>") #f (u . "\n<p>After reinstalling <code>java</code> from <code>brew cask</code>, it could happen that Maven does not find anymore the JAVA_HOME. The error looks like this:</p>\n\n<div class=\"brush: console\">\n <div class=\"highlight\">\n  <pre><span></span><span class=\"gp\">$</span> mvn clean install\n<span class=\"go\">The JAVA_HOME environment variable is not defined correctly</span>\n<span class=\"go\">This environment variable is needed to run this program</span>\n<span class=\"go\">NB: JAVA_HOME should point to a JDK not a JR</span>\n</pre></div>\n\n</div>\n\n<p>In Fish shell, on Mac OS X, the solution is to set the variable in universal mode:</p>\n\n<div class=\"brush: console\">\n <div class=\"highlight\">\n  <pre><span></span><span class=\"gp\">$</span> <span class=\"nb\">set</span> -U JAVA_HOME <span class=\"o\">(</span>/usr/libexec/java_home<span class=\"o\">)</span>\n</pre></div>\n\n</div>")) ((? . 17) f post (u . "Logging start and finish in Python") (? . 17) 1535126483 (p+ #"/Users/luis/Documents/code/logc.github.io/blog/2018/06/04/logging-start-and-finish-in-python/index.html" . unix) (u . "/blog/2018/06/04/logging-start-and-finish-in-python/") (u . "2018-06-04T20:07:09") (? . 16) (? . 4) (c (u . "python")) (u . "\n<p>Just a quick post on how to log, in simple Python scripts, the start and finish times of a function.</p>\n\n<div class=\"brush: python\">\n <div class=\"highlight\">\n  <pre><span></span><span class=\"kn\">import</span> <span class=\"nn\">logging</span>\n<span class=\"kn\">import</span> <span class=\"nn\">time</span>\n<span class=\"kn\">import</span> <span class=\"nn\">sys</span>\n\n\n<span class=\"k\">def</span> <span class=\"nf\">main</span><span class=\"p\">():</span>\n    <span class=\"n\">start</span> <span class=\"o\">=</span> <span class=\"n\">time</span><span class=\"o\">.</span><span class=\"n\">time</span><span class=\"p\">()</span>\n    <span class=\"n\">logging</span><span class=\"o\">.</span><span class=\"n\">basicConfig</span><span class=\"p\">(</span>\n        <span class=\"n\">level</span><span class=\"o\">=</span><span class=\"n\">logging</span><span class=\"o\">.</span><span class=\"n\">DEBUG</span><span class=\"p\">,</span>\n        <span class=\"n\">format</span><span class=\"o\">=</span><span class=\"s1\">&#39;</span><span class=\"si\">%(asctime)s</span><span class=\"s1\"> </span><span class=\"si\">%(levelname)s</span><span class=\"s1\"> - </span><span class=\"si\">%(message)s</span><span class=\"s1\">&#39;</span><span class=\"p\">,</span>\n        <span class=\"n\">datefmt</span><span class=\"o\">=</span><span class=\"s1\">&#39;%H:%M:%S&#39;</span><span class=\"p\">,</span>\n    <span class=\"p\">)</span>\n    <span class=\"n\">logging</span><span class=\"o\">.</span><span class=\"n\">info</span><span class=\"p\">(</span><span class=\"s2\">\"Start processing after </span><span class=\"si\">%s</span><span class=\"s2\">\"</span><span class=\"p\">,</span> <span class=\"n\">format_time_since</span><span class=\"p\">(</span><span class=\"n\">start</span><span class=\"p\">))</span>\n    <span class=\"c1\"># Do some processing ...</span>\n    <span class=\"n\">logging</span><span class=\"o\">.</span><span class=\"n\">info</span><span class=\"p\">(</span><span class=\"s2\">\"Finished processing after </span><span class=\"si\">%s</span><span class=\"s2\">\"</span><span class=\"p\">,</span> <span class=\"n\">format_time_since</span><span class=\"p\">(</span><span class=\"n\">start</span><span class=\"p\">))</span>\n    <span class=\"n\">sys</span><span class=\"o\">.</span><span class=\"n\">exit</span><span class=\"p\">(</span><span class=\"mi\">0</span><span class=\"p\">)</span>\n\n\n<span class=\"k\">def</span> <span class=\"nf\">format_time_since</span><span class=\"p\">(</span><span class=\"n\">start</span><span class=\"p\">):</span>\n    <span class=\"n\">now</span> <span class=\"o\">=</span> <span class=\"n\">time</span><span class=\"o\">.</span><span class=\"n\">time</span><span class=\"p\">()</span>\n    <span class=\"n\">elapsed</span> <span class=\"o\">=</span> <span class=\"n\">now</span> <span class=\"o\">-</span> <span class=\"n\">start</span>\n    <span class=\"k\">return</span> <span class=\"n\">time</span><span class=\"o\">.</span><span class=\"n\">strftime</span><span class=\"p\">(</span><span class=\"s2\">\"%H:%M:%S\"</span><span class=\"p\">,</span> <span class=\"n\">time</span><span class=\"o\">.</span><span class=\"n\">gmtime</span><span class=\"p\">(</span><span class=\"n\">elapsed</span><span class=\"p\">))</span>\n</pre></div>\n\n</div>") #f (u . "\n<p>Just a quick post on how to log, in simple Python scripts, the start and finish times of a function.</p>\n\n<div class=\"brush: python\">\n <div class=\"highlight\">\n  <pre><span></span><span class=\"kn\">import</span> <span class=\"nn\">logging</span>\n<span class=\"kn\">import</span> <span class=\"nn\">time</span>\n<span class=\"kn\">import</span> <span class=\"nn\">sys</span>\n\n\n<span class=\"k\">def</span> <span class=\"nf\">main</span><span class=\"p\">():</span>\n    <span class=\"n\">start</span> <span class=\"o\">=</span> <span class=\"n\">time</span><span class=\"o\">.</span><span class=\"n\">time</span><span class=\"p\">()</span>\n    <span class=\"n\">logging</span><span class=\"o\">.</span><span class=\"n\">basicConfig</span><span class=\"p\">(</span>\n        <span class=\"n\">level</span><span class=\"o\">=</span><span class=\"n\">logging</span><span class=\"o\">.</span><span class=\"n\">DEBUG</span><span class=\"p\">,</span>\n        <span class=\"n\">format</span><span class=\"o\">=</span><span class=\"s1\">&#39;</span><span class=\"si\">%(asctime)s</span><span class=\"s1\"> </span><span class=\"si\">%(levelname)s</span><span class=\"s1\"> - </span><span class=\"si\">%(message)s</span><span class=\"s1\">&#39;</span><span class=\"p\">,</span>\n        <span class=\"n\">datefmt</span><span class=\"o\">=</span><span class=\"s1\">&#39;%H:%M:%S&#39;</span><span class=\"p\">,</span>\n    <span class=\"p\">)</span>\n    <span class=\"n\">logging</span><span class=\"o\">.</span><span class=\"n\">info</span><span class=\"p\">(</span><span class=\"s2\">\"Start processing after </span><span class=\"si\">%s</span><span class=\"s2\">\"</span><span class=\"p\">,</span> <span class=\"n\">format_time_since</span><span class=\"p\">(</span><span class=\"n\">start</span><span class=\"p\">))</span>\n    <span class=\"c1\"># Do some processing ...</span>\n    <span class=\"n\">logging</span><span class=\"o\">.</span><span class=\"n\">info</span><span class=\"p\">(</span><span class=\"s2\">\"Finished processing after </span><span class=\"si\">%s</span><span class=\"s2\">\"</span><span class=\"p\">,</span> <span class=\"n\">format_time_since</span><span class=\"p\">(</span><span class=\"n\">start</span><span class=\"p\">))</span>\n    <span class=\"n\">sys</span><span class=\"o\">.</span><span class=\"n\">exit</span><span class=\"p\">(</span><span class=\"mi\">0</span><span class=\"p\">)</span>\n\n\n<span class=\"k\">def</span> <span class=\"nf\">format_time_since</span><span class=\"p\">(</span><span class=\"n\">start</span><span class=\"p\">):</span>\n    <span class=\"n\">now</span> <span class=\"o\">=</span> <span class=\"n\">time</span><span class=\"o\">.</span><span class=\"n\">time</span><span class=\"p\">()</span>\n    <span class=\"n\">elapsed</span> <span class=\"o\">=</span> <span class=\"n\">now</span> <span class=\"o\">-</span> <span class=\"n\">start</span>\n    <span class=\"k\">return</span> <span class=\"n\">time</span><span class=\"o\">.</span><span class=\"n\">strftime</span><span class=\"p\">(</span><span class=\"s2\">\"%H:%M:%S\"</span><span class=\"p\">,</span> <span class=\"n\">time</span><span class=\"o\">.</span><span class=\"n\">gmtime</span><span class=\"p\">(</span><span class=\"n\">elapsed</span><span class=\"p\">))</span>\n</pre></div>\n\n</div>")) ((? . 20) f post (u . "Reduce in standard C++") (? . 20) 1535126483 (p+ #"/Users/luis/Documents/code/logc.github.io/blog/2014/01/20/reduce-in-standard-c/index.html" . unix) (u . "/blog/2014/01/20/reduce-in-standard-c/") (u . "2014-01-20T13:47:25Z+0100") (? . 21) (? . 10) (c (u . "C++")) (u . "\n<h2 id=\"accumulate-instead-of-loop\">Accumulate instead of loop</h2>\n\n<p>You can traverse a C++ vector in many ways. Looping over a counter variable that goes from 0 to the vector size or taking an iterator from the vector&rsquo;s <code>begin</code> to its <code>end</code> pointer positions are well-known ways to access its elements. When you are collapsing the elements into a single accumulator value (an operation usually called <code>reduce</code> in functional programming), you can use the <code>std::accumulate</code> function in the <code>numeric</code> header.</p>") #t (u . "\n<h2 id=\"accumulate-instead-of-loop\">Accumulate instead of loop</h2>\n\n<p>You can traverse a C++ vector in many ways. Looping over a counter variable that goes from 0 to the vector size or taking an iterator from the vector&rsquo;s <code>begin</code> to its <code>end</code> pointer positions are well-known ways to access its elements. When you are collapsing the elements into a single accumulator value (an operation usually called <code>reduce</code> in functional programming), you can use the <code>std::accumulate</code> function in the <code>numeric</code> header.</p>\n<!-- more-->\n\n<div class=\"brush: c++\">\n <div class=\"highlight\">\n  <pre><span></span><span class=\"cp\">#include</span> <span class=\"cpf\">&lt;iostream&gt;</span><span class=\"cp\"></span>\n<span class=\"cp\">#include</span> <span class=\"cpf\">&lt;vector&gt;</span><span class=\"cp\"></span>\n<span class=\"cp\">#include</span> <span class=\"cpf\">&lt;numeric&gt;</span><span class=\"cp\"></span>\n\n<span class=\"k\">struct</span> <span class=\"n\">cell</span> <span class=\"p\">{</span>\n    <span class=\"kt\">double</span> <span class=\"n\">probability</span><span class=\"p\">;</span>\n<span class=\"p\">};</span>\n\n<span class=\"kt\">int</span> <span class=\"nf\">main</span><span class=\"p\">()</span>\n<span class=\"p\">{</span>\n    <span class=\"kt\">double</span> <span class=\"n\">result</span><span class=\"p\">;</span>\n    <span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">vector</span><span class=\"o\">&lt;</span><span class=\"n\">cell</span><span class=\"o\">&gt;</span> <span class=\"n\">grid</span><span class=\"p\">;</span>\n    <span class=\"k\">for</span> <span class=\"p\">(</span><span class=\"kt\">size_t</span> <span class=\"n\">i</span> <span class=\"o\">=</span> <span class=\"mi\">0</span><span class=\"p\">;</span> <span class=\"n\">i</span> <span class=\"o\">&lt;</span> <span class=\"mi\">3</span><span class=\"p\">;</span> <span class=\"n\">i</span><span class=\"o\">++</span><span class=\"p\">)</span> <span class=\"p\">{</span>\n        <span class=\"n\">cell</span> <span class=\"n\">c</span> <span class=\"o\">=</span> <span class=\"p\">{.</span><span class=\"n\">probability</span> <span class=\"o\">=</span> <span class=\"mf\">0.1</span> <span class=\"o\">*</span> <span class=\"n\">i</span><span class=\"p\">};</span>\n        <span class=\"n\">grid</span><span class=\"p\">.</span><span class=\"n\">push_back</span><span class=\"p\">(</span><span class=\"n\">c</span><span class=\"p\">);</span>\n    <span class=\"p\">}</span>\n\n    <span class=\"n\">result</span> <span class=\"o\">=</span> <span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">accumulate</span><span class=\"p\">(</span>\n        <span class=\"n\">grid</span><span class=\"p\">.</span><span class=\"n\">begin</span><span class=\"p\">(),</span> <span class=\"n\">grid</span><span class=\"p\">.</span><span class=\"n\">end</span><span class=\"p\">(),</span> <span class=\"mf\">0.0</span><span class=\"p\">,</span>\n        <span class=\"p\">[]</span> <span class=\"p\">(</span><span class=\"kt\">double</span> <span class=\"n\">sum</span><span class=\"p\">,</span> <span class=\"k\">const</span> <span class=\"n\">cell</span><span class=\"o\">&amp;</span> <span class=\"n\">c</span><span class=\"p\">)</span> <span class=\"p\">{</span><span class=\"k\">return</span> <span class=\"n\">sum</span> <span class=\"o\">+</span> <span class=\"n\">c</span><span class=\"p\">.</span><span class=\"n\">probability</span><span class=\"p\">;});</span>\n    <span class=\"n\">std</span><span class=\"o\">::</span><span class=\"n\">cout</span> <span class=\"o\">&lt;&lt;</span> <span class=\"n\">result</span><span class=\"p\">;</span>\n    <span class=\"k\">return</span> <span class=\"mi\">0</span><span class=\"p\">;</span>\n<span class=\"p\">}</span>\n</pre></div>\n\n</div>\n\n<h2 id=\"compile-and-run\">Compile and run</h2>\n\n<p>In this example, the compilation needs a <code>-std=c++11</code> flag in order to set the standard to C++11, a fairly recent standard that is not supported by all compilers and systems. However, the part that is written in this new standard is the <em>accumulating function</em>, which is expressed as a lambda in this example. If you move its code to a named function outside the <code>main</code>, this code should compile with many more compilers.</p>\n\n<div class=\"brush: console\">\n <div class=\"highlight\">\n  <pre><span></span><span class=\"gp\">$</span> c++ main.cpp -o example -std<span class=\"o\">=</span>c++11 <span class=\"o\">&amp;&amp;</span> ./example\n<span class=\"go\">0.3</span>\n</pre></div>\n\n</div>")) ((? . 22) f post (u . "Minimal C project structure with SCons") (? . 22) 1535126483 (p+ #"/Users/luis/Documents/code/logc.github.io/blog/2016/10/20/minimal-c-project-structure-with-scons/index.html" . unix) (u . "/blog/2016/10/20/minimal-c-project-structure-with-scons/") (u . "2016-10-20T20:17:59") (? . 23) (? . 11) (c (u . "C") c (u . "scons") c (u . "build")) (u . "\n<p>This is a possible project structure in order to have a C project using SCons as the build system. It enables you to:</p>\n\n<ul>\n <li>compile most files as a library, and link that to a <code>main</code> file with application code.</li>\n <li>separate <code>src</code> and <code>include</code> directories</li>\n <li>separate unit tests using libcheck</li>\n <li>the unit tests link to the library</li>\n <li>Macports-installed libraries</li></ul>\n\n<p>Layout your code like this:</p>\n\n<pre><code>.\n├── include\n│   └── core\n│       └── mylib.h\n├── sconstruct\n├── src\n│   ├── core\n│   │   └── mylib.c\n│   └── main.c\n└── tests\n    ├── core\n    │   ├── test_mylib.c\n    │   ├── test_mylib.h\n    │   └── tests.h\n    └── main.c</code></pre>\n\n<p>where <code>mylib</code> should have a more descriptive name for your project.</p>\n\n<p><code>sconstruct</code> is:</p>\n\n<div class=\"brush: python\">\n <div class=\"highlight\">\n  <pre><span></span><span class=\"n\">env</span> <span class=\"o\">=</span> <span class=\"n\">Environment</span><span class=\"p\">(</span><span class=\"n\">CPPPATH</span><span class=\"o\">=</span><span class=\"p\">[</span><span class=\"s1\">&#39;include&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;/opt/local/include&#39;</span><span class=\"p\">])</span>\n<span class=\"n\">env</span><span class=\"o\">.</span><span class=\"n\">Library</span><span class=\"p\">(</span><span class=\"n\">target</span><span class=\"o\">=</span><span class=\"s1\">&#39;mylib&#39;</span><span class=\"p\">,</span> <span class=\"n\">source</span><span class=\"o\">=</span><span class=\"n\">Glob</span><span class=\"p\">(</span><span class=\"s1\">&#39;src/core/*.c&#39;</span><span class=\"p\">))</span>\n<span class=\"n\">env</span><span class=\"o\">.</span><span class=\"n\">Program</span><span class=\"p\">(</span><span class=\"n\">target</span><span class=\"o\">=</span><span class=\"s1\">&#39;mylib&#39;</span><span class=\"p\">,</span> <span class=\"n\">source</span><span class=\"o\">=</span><span class=\"n\">Glob</span><span class=\"p\">(</span><span class=\"s1\">&#39;src/*.c&#39;</span><span class=\"p\">),</span>\n            <span class=\"n\">LIBS</span><span class=\"o\">=</span><span class=\"p\">[</span><span class=\"s1\">&#39;mylib&#39;</span><span class=\"p\">],</span> <span class=\"n\">LIBPATH</span><span class=\"o\">=</span><span class=\"p\">[</span><span class=\"s1\">&#39;.&#39;</span><span class=\"p\">])</span>\n<span class=\"n\">env</span><span class=\"o\">.</span><span class=\"n\">Program</span><span class=\"p\">(</span><span class=\"n\">target</span><span class=\"o\">=</span><span class=\"s1\">&#39;test_mylib&#39;</span><span class=\"p\">,</span> <span class=\"n\">source</span><span class=\"o\">=</span><span class=\"n\">Glob</span><span class=\"p\">(</span><span class=\"s1\">&#39;tests/*.c&#39;</span><span class=\"p\">)</span> <span class=\"o\">+</span> <span class=\"n\">Glob</span><span class=\"p\">(</span><span class=\"s1\">&#39;tests/**/*.c&#39;</span><span class=\"p\">),</span>\n            <span class=\"n\">LIBS</span><span class=\"o\">=</span><span class=\"p\">[</span><span class=\"s1\">&#39;mylib&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;check&#39;</span><span class=\"p\">],</span> <span class=\"n\">LIBPATH</span><span class=\"o\">=</span><span class=\"p\">[</span><span class=\"s1\">&#39;.&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;/opt/local/lib/&#39;</span><span class=\"p\">])</span>\n</pre></div>\n\n</div>") #t (u . "\n<p>This is a possible project structure in order to have a C project using SCons as the build system. It enables you to:</p>\n\n<ul>\n <li>compile most files as a library, and link that to a <code>main</code> file with application code.</li>\n <li>separate <code>src</code> and <code>include</code> directories</li>\n <li>separate unit tests using libcheck</li>\n <li>the unit tests link to the library</li>\n <li>Macports-installed libraries</li></ul>\n\n<p>Layout your code like this:</p>\n\n<pre><code>.\n├── include\n│   └── core\n│       └── mylib.h\n├── sconstruct\n├── src\n│   ├── core\n│   │   └── mylib.c\n│   └── main.c\n└── tests\n    ├── core\n    │   ├── test_mylib.c\n    │   ├── test_mylib.h\n    │   └── tests.h\n    └── main.c</code></pre>\n\n<p>where <code>mylib</code> should have a more descriptive name for your project.</p>\n\n<p><code>sconstruct</code> is:</p>\n\n<div class=\"brush: python\">\n <div class=\"highlight\">\n  <pre><span></span><span class=\"n\">env</span> <span class=\"o\">=</span> <span class=\"n\">Environment</span><span class=\"p\">(</span><span class=\"n\">CPPPATH</span><span class=\"o\">=</span><span class=\"p\">[</span><span class=\"s1\">&#39;include&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;/opt/local/include&#39;</span><span class=\"p\">])</span>\n<span class=\"n\">env</span><span class=\"o\">.</span><span class=\"n\">Library</span><span class=\"p\">(</span><span class=\"n\">target</span><span class=\"o\">=</span><span class=\"s1\">&#39;mylib&#39;</span><span class=\"p\">,</span> <span class=\"n\">source</span><span class=\"o\">=</span><span class=\"n\">Glob</span><span class=\"p\">(</span><span class=\"s1\">&#39;src/core/*.c&#39;</span><span class=\"p\">))</span>\n<span class=\"n\">env</span><span class=\"o\">.</span><span class=\"n\">Program</span><span class=\"p\">(</span><span class=\"n\">target</span><span class=\"o\">=</span><span class=\"s1\">&#39;mylib&#39;</span><span class=\"p\">,</span> <span class=\"n\">source</span><span class=\"o\">=</span><span class=\"n\">Glob</span><span class=\"p\">(</span><span class=\"s1\">&#39;src/*.c&#39;</span><span class=\"p\">),</span>\n            <span class=\"n\">LIBS</span><span class=\"o\">=</span><span class=\"p\">[</span><span class=\"s1\">&#39;mylib&#39;</span><span class=\"p\">],</span> <span class=\"n\">LIBPATH</span><span class=\"o\">=</span><span class=\"p\">[</span><span class=\"s1\">&#39;.&#39;</span><span class=\"p\">])</span>\n<span class=\"n\">env</span><span class=\"o\">.</span><span class=\"n\">Program</span><span class=\"p\">(</span><span class=\"n\">target</span><span class=\"o\">=</span><span class=\"s1\">&#39;test_mylib&#39;</span><span class=\"p\">,</span> <span class=\"n\">source</span><span class=\"o\">=</span><span class=\"n\">Glob</span><span class=\"p\">(</span><span class=\"s1\">&#39;tests/*.c&#39;</span><span class=\"p\">)</span> <span class=\"o\">+</span> <span class=\"n\">Glob</span><span class=\"p\">(</span><span class=\"s1\">&#39;tests/**/*.c&#39;</span><span class=\"p\">),</span>\n            <span class=\"n\">LIBS</span><span class=\"o\">=</span><span class=\"p\">[</span><span class=\"s1\">&#39;mylib&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;check&#39;</span><span class=\"p\">],</span> <span class=\"n\">LIBPATH</span><span class=\"o\">=</span><span class=\"p\">[</span><span class=\"s1\">&#39;.&#39;</span><span class=\"p\">,</span> <span class=\"s1\">&#39;/opt/local/lib/&#39;</span><span class=\"p\">])</span>\n</pre></div>\n\n</div>\n<!-- more-->\n\n<h2 id=\"implementation\">Implementation</h2>\n\n<p><code>src/core/mylib.c</code> (and all other files in subdirectories of <code>src/</code>) holds the core logic without user interactions (pure functions, if you wish :) ). It can look like this:</p>\n\n<div class=\"brush: c\">\n <div class=\"highlight\">\n  <pre><span></span><span class=\"kt\">int</span> <span class=\"nf\">whatever</span><span class=\"p\">()</span> <span class=\"p\">{</span>\n    <span class=\"k\">return</span> <span class=\"mi\">0</span><span class=\"p\">;</span>\n<span class=\"p\">}</span>\n</pre></div>\n\n</div>\n\n<p><code>src/main.c</code> uses all other files in order to do something useful for a user. For instance:</p>\n\n<div class=\"brush: c\">\n <div class=\"highlight\">\n  <pre><span></span><span class=\"cp\">#include</span> <span class=\"cpf\">\"core/mylib.h\"</span><span class=\"cp\"></span>\n\n<span class=\"kt\">int</span> <span class=\"nf\">main</span><span class=\"p\">()</span> <span class=\"p\">{</span>\n    <span class=\"k\">return</span> <span class=\"n\">whatever</span><span class=\"p\">();</span>\n<span class=\"p\">}</span>\n</pre></div>\n\n</div>\n\n<p><code>main.c</code> and <code>core/mylib.c</code> see each other via the header files in the include directory, where <code>core/mylib.h</code> holds:</p>\n\n<div class=\"brush: c\">\n <div class=\"highlight\">\n  <pre><span></span><span class=\"kt\">int</span> <span class=\"nf\">whatever</span><span class=\"p\">();</span>\n</pre></div>\n\n</div>\n\n<h2 id=\"tests\">Tests</h2>\n\n<p>Tests have the same subdirectory structure as the source subtree (a <code>core</code> directory to hold tests for <code>core</code> implementation files), but headers are included in the same subtree, because tests are not expected to need to publish their API to end-users, only their results.</p>\n\n<p>A typical test file, e.g. <code>tests/core/test_mylib.c</code>, should define tests, and then define a function that puts them together into a test suite. This is the function that we will want to expose via a header file:</p>\n\n<div class=\"brush: c\">\n <div class=\"highlight\">\n  <pre><span></span><span class=\"cp\">#include</span> <span class=\"cpf\">&lt;check.h&gt;</span><span class=\"cp\"></span>\n\n<span class=\"n\">START_TEST</span><span class=\"p\">(</span><span class=\"n\">test_fails</span><span class=\"p\">)</span>\n<span class=\"p\">{</span>\n    <span class=\"n\">ck_assert_int_eq</span><span class=\"p\">(</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">2</span><span class=\"p\">);</span>\n<span class=\"p\">}</span>\n<span class=\"n\">END_TEST</span>\n\n<span class=\"n\">Suite</span> <span class=\"o\">*</span> <span class=\"n\">core_suite</span><span class=\"p\">(</span><span class=\"kt\">void</span><span class=\"p\">)</span>\n<span class=\"p\">{</span>\n    <span class=\"n\">Suite</span> <span class=\"o\">*</span><span class=\"n\">s</span><span class=\"p\">;</span>\n    <span class=\"n\">TCase</span> <span class=\"o\">*</span><span class=\"n\">tc_core</span><span class=\"p\">;</span>\n\n    <span class=\"n\">s</span> <span class=\"o\">=</span> <span class=\"n\">suite_create</span><span class=\"p\">(</span><span class=\"s\">\"Core/mylib\"</span><span class=\"p\">);</span>\n\n    <span class=\"cm\">/* Core test case */</span>\n    <span class=\"n\">tc_core</span> <span class=\"o\">=</span> <span class=\"n\">tcase_create</span><span class=\"p\">(</span><span class=\"s\">\"Core\"</span><span class=\"p\">);</span>\n\n    <span class=\"n\">tcase_add_test</span><span class=\"p\">(</span><span class=\"n\">tc_core</span><span class=\"p\">,</span> <span class=\"n\">test_fails</span><span class=\"p\">);</span>\n    <span class=\"n\">suite_add_tcase</span><span class=\"p\">(</span><span class=\"n\">s</span><span class=\"p\">,</span> <span class=\"n\">tc_core</span><span class=\"p\">);</span>\n\n    <span class=\"k\">return</span> <span class=\"n\">s</span><span class=\"p\">;</span>\n<span class=\"p\">}</span>\n</pre></div>\n\n</div>\n\n<p>In this example, we create a header file for each test file in a directory, and then an aggregated header file called <code>tests.h</code> which includes all other header files in the same directory:</p>\n\n<div class=\"brush: c\">\n <div class=\"highlight\">\n  <pre><span></span><span class=\"c1\">// test_mylib.h</span>\n<span class=\"n\">Suite</span> <span class=\"o\">*</span> <span class=\"nf\">core_suite</span><span class=\"p\">(</span><span class=\"kt\">void</span><span class=\"p\">);</span>\n\n<span class=\"c1\">// tests.h</span>\n<span class=\"cp\">#include</span> <span class=\"cpf\">\"test_mylib.h\"</span><span class=\"cp\"></span>\n</pre></div>\n\n</div>\n\n<p>Finally, the test runner executable is defined in the tests/main.c file. It includes all tests headers, uses the exported test suite creating functions to create all test suites, and runs them.</p>\n\n<div class=\"brush: c\">\n <div class=\"highlight\">\n  <pre><span></span><span class=\"c1\">// tests/main.c</span>\n<span class=\"cp\">#include</span> <span class=\"cpf\">&lt;stdlib.h&gt;</span><span class=\"cp\"></span>\n\n<span class=\"cp\">#include</span> <span class=\"cpf\">&lt;check.h&gt;</span><span class=\"cp\"></span>\n\n<span class=\"cp\">#include</span> <span class=\"cpf\">\"core/tests.h\"</span><span class=\"cp\"></span>\n\n<span class=\"kt\">int</span> <span class=\"nf\">main</span><span class=\"p\">(</span><span class=\"kt\">void</span><span class=\"p\">)</span>\n<span class=\"p\">{</span>\n    <span class=\"kt\">int</span> <span class=\"n\">number_failed</span><span class=\"p\">;</span>\n    <span class=\"n\">Suite</span> <span class=\"o\">*</span><span class=\"n\">s</span><span class=\"p\">;</span>\n    <span class=\"n\">SRunner</span> <span class=\"o\">*</span><span class=\"n\">sr</span><span class=\"p\">;</span>\n\n    <span class=\"n\">s</span> <span class=\"o\">=</span> <span class=\"n\">core_suite</span><span class=\"p\">();</span>\n    <span class=\"n\">sr</span> <span class=\"o\">=</span> <span class=\"n\">srunner_create</span><span class=\"p\">(</span><span class=\"n\">s</span><span class=\"p\">);</span>\n\n    <span class=\"n\">srunner_run_all</span><span class=\"p\">(</span><span class=\"n\">sr</span><span class=\"p\">,</span> <span class=\"n\">CK_NORMAL</span><span class=\"p\">);</span>\n    <span class=\"n\">number_failed</span> <span class=\"o\">=</span> <span class=\"n\">srunner_ntests_failed</span><span class=\"p\">(</span><span class=\"n\">sr</span><span class=\"p\">);</span>\n    <span class=\"n\">srunner_free</span><span class=\"p\">(</span><span class=\"n\">sr</span><span class=\"p\">);</span>\n    <span class=\"k\">return</span> <span class=\"p\">(</span><span class=\"n\">number_failed</span> <span class=\"o\">==</span> <span class=\"mi\">0</span><span class=\"p\">)</span> <span class=\"o\">?</span> <span class=\"nl\">EXIT_SUCCESS</span> <span class=\"p\">:</span> <span class=\"n\">EXIT_FAILURE</span><span class=\"p\">;</span>\n<span class=\"p\">}</span>\n</pre></div>\n\n</div>\n\n<h2 id=\"usage\">Usage</h2>\n\n<p>Build your project with:</p>\n\n<pre><code>$ scons</code></pre>\n\n<p>You will find three products:</p>\n\n<ul>\n <li>a static library called <code>libmylib</code></li>\n <li>an executable called <code>mylib</code>, which links to that library</li>\n <li>a test executable called <code>test_mylib</code>, also linked to that library</li></ul>\n\n<p>You can run all tests with <code>./test_mylib</code>, and execute the program with <code>./mylib</code></p>\n\n<p>You can clean all object files and the products with</p>\n\n<pre><code>$ scons --clean</code></pre>")) ((? . 5) f post (u . "Ensime server crashed by wrong JAR") (? . 5) 1535126483 (p+ #"/Users/luis/Documents/code/logc.github.io/blog/2018/08/09/ensime-server-crashed-by-wrong-jar/index.html" . unix) (u . "/blog/2018/08/09/ensime-server-crashed-by-wrong-jar/") (u . "2018-08-09T14:10:00") (? . 4) (? . 1) (c (u . "scala") c (u . "ensime") c (u . "spacemacs")) (u . "\n<p>If you have a dodgy source jar file, it will probably blow up the ensime server with java.util.zip.ZipException: error in opening zip file. The solution offered in <a href=\"https://github.com/ensime/ensime-server/issues/825\">the project&rsquo;s Github issue</a> is to delete your local copy of the bad file and add it to the list of excluded classifiers in ivy (i.e. <code>~/.ivy2/exclude_classifiers</code>), and report the file to the nexus hosts to have it deleted.</p>\n\n<p>Mine is a bit longer &hellip;</p>") #t (u . "\n<p>If you have a dodgy source jar file, it will probably blow up the ensime server with java.util.zip.ZipException: error in opening zip file. The solution offered in <a href=\"https://github.com/ensime/ensime-server/issues/825\">the project&rsquo;s Github issue</a> is to delete your local copy of the bad file and add it to the list of excluded classifiers in ivy (i.e. <code>~/.ivy2/exclude_classifiers</code>), and report the file to the nexus hosts to have it deleted.</p>\n\n<p>Mine is a bit longer &hellip;</p>\n<!-- more-->\n\n<p>I struggled with this error for weeks! In my case, the offending JAR was a transitive dependency of a project, and the solution offered here was not clear enough for me.</p>\n\n<p>This problem is tricky if you previously loaded the project into an IDE: they download by default all transitive dependencies with sources and javadoc, and the ivy cache is shared by all projects in the same machine.</p>\n\n<p>Here is my solution, in case it helps others:</p>\n\n<ul>\n <li>determine which dependency is pulling the problem JAR with the <a href=\"https://github.com/jrudolph/sbt-dependency-graph\">sbt dependency  graph plugin</a> (note: the  command <code>whatDependsOn</code> only works in interactive mode)</li>\n <li>move away the current ivy cache folder <code>console\n$ mv ~/.ivy2/ ~/.ivy2_old</code></li>\n <li>(optional) create a new clone to have a known state <code>console\n$ git clone $repo ~/dev/ensime-$repo</code></li>\n <li>edit <code>build.sbt</code> to add an exclusion rule for the transitive dependency at the line of the explicit dependency that needs it, e.g. <code>sbt\nlibraryDependencies ++= Seq(\n  \"com.company.notifications\" % \"notifications-schema\" exclude(\"org.json\", \"json\")\n)</code></li>\n <li>compile, go for a coffee while ivy downloads the internet :smile:, then run ensime commands <code>console\n$ sbt compile\n$ sbt ensimeConfig ensimeConfigProject</code></li></ul>")) ((? . 24) f post (u . "Compilar Cython") (? . 24) 1535126483 (p+ #"/Users/luis/Documents/code/logc.github.io/blog/2013/11/19/compilar-cython/index.html" . unix) (u . "/blog/2013/11/19/compilar-cython/") (u . "2013-11-19T08:30:14Z+0100") (? . 8) (? . 25) (c (u . "python")) (u . "\n<p>Compilar ficheros de Cython es más fácil usando la función <code>cythonize</code> dentro del setup.py de nuestro proyecto:</p>\n\n<div class=\"brush: python\">\n <div class=\"highlight\">\n  <pre><span></span><span class=\"c1\"># File: setup.py</span>\n\n<span class=\"kn\">from</span> <span class=\"nn\">distutils.core</span> <span class=\"kn\">import</span> <span class=\"n\">setup</span>\n<span class=\"kn\">from</span> <span class=\"nn\">Cython.Build</span> <span class=\"kn\">import</span> <span class=\"n\">cythonize</span>\n\n<span class=\"n\">setup</span><span class=\"p\">(</span>\n      <span class=\"n\">name</span> <span class=\"o\">=</span> <span class=\"s2\">\"My hello app\"</span><span class=\"p\">,</span>\n      <span class=\"n\">ext_modules</span> <span class=\"o\">=</span> <span class=\"n\">cythonize</span><span class=\"p\">(</span><span class=\"s1\">&#39;fibonacci.pyx&#39;</span><span class=\"p\">),</span> <span class=\"c1\"># accepts a glob pattern</span>\n<span class=\"p\">)</span>\n</pre></div>\n\n</div>\n\n<p>Por ejemplo, el fichero a compilar es fibonacci.pyx, que contiene un ejemplo del tutorial de Cython:</p>\n\n<div class=\"brush: python\">\n <div class=\"highlight\">\n  <pre><span></span><span class=\"c1\"># File: fibonacci.pyx</span>\n\n<span class=\"k\">def</span> <span class=\"nf\">fib</span><span class=\"p\">(</span><span class=\"n\">n</span><span class=\"p\">):</span>\n    <span class=\"n\">a</span><span class=\"p\">,</span> <span class=\"n\">b</span> <span class=\"o\">=</span> <span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">1</span>\n    <span class=\"k\">while</span> <span class=\"n\">b</span> <span class=\"o\">&lt;</span> <span class=\"n\">n</span><span class=\"p\">:</span>\n        <span class=\"k\">print</span> <span class=\"n\">b</span><span class=\"p\">,</span>\n        <span class=\"n\">a</span><span class=\"p\">,</span> <span class=\"n\">b</span> <span class=\"o\">=</span> <span class=\"n\">b</span><span class=\"p\">,</span> <span class=\"n\">a</span> <span class=\"o\">+</span> <span class=\"n\">b</span>\n</pre></div>\n\n</div>\n\n<p>El resultado de compilar <code>fibonacci.pyx</code> es un fichero con código intermedio en C <code>fibonacci.c</code> y un fichero compilado <code>fibonacci.so</code>.</p>\n\n<div class=\"brush: bash\">\n <div class=\"highlight\">\n  <pre><span></span>$ python setup.py build\nrunning build\nrunning build_ext\nbuilding <span class=\"s1\">&#39;fibonacci&#39;</span> extension\n/usr/bin/clang ...snip... -o build/lib.macosx-10.8-x86_64-2.7/fibonacci.so\n</pre></div>\n\n</div>\n\n<blockquote>\n <p><strong>note</strong></p>\n <p>El compilador que se utiliza es el que sea por defecto del sistema en ese momento. Aún estoy investigando cómo seleccionar un compilador en concreto, o añadir librerías y flags.</p></blockquote>\n\n<p>El fichero .so puede usarse desde otros módulos de Python, o directamente desde la shell</p>\n\n<div class=\"brush: pycon\">\n <div class=\"highlight\">\n  <pre><span></span><span class=\"gp\">&gt;&gt;&gt; </span><span class=\"kn\">import</span> <span class=\"nn\">fibonacci</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">fibonacci</span><span class=\"o\">.</span><span class=\"n\">fib</span><span class=\"p\">(</span><span class=\"mi\">5</span><span class=\"p\">)</span>\n<span class=\"go\">1 1 2 3</span>\n</pre></div>\n\n</div>") #f (u . "\n<p>Compilar ficheros de Cython es más fácil usando la función <code>cythonize</code> dentro del setup.py de nuestro proyecto:</p>\n\n<div class=\"brush: python\">\n <div class=\"highlight\">\n  <pre><span></span><span class=\"c1\"># File: setup.py</span>\n\n<span class=\"kn\">from</span> <span class=\"nn\">distutils.core</span> <span class=\"kn\">import</span> <span class=\"n\">setup</span>\n<span class=\"kn\">from</span> <span class=\"nn\">Cython.Build</span> <span class=\"kn\">import</span> <span class=\"n\">cythonize</span>\n\n<span class=\"n\">setup</span><span class=\"p\">(</span>\n      <span class=\"n\">name</span> <span class=\"o\">=</span> <span class=\"s2\">\"My hello app\"</span><span class=\"p\">,</span>\n      <span class=\"n\">ext_modules</span> <span class=\"o\">=</span> <span class=\"n\">cythonize</span><span class=\"p\">(</span><span class=\"s1\">&#39;fibonacci.pyx&#39;</span><span class=\"p\">),</span> <span class=\"c1\"># accepts a glob pattern</span>\n<span class=\"p\">)</span>\n</pre></div>\n\n</div>\n\n<p>Por ejemplo, el fichero a compilar es fibonacci.pyx, que contiene un ejemplo del tutorial de Cython:</p>\n\n<div class=\"brush: python\">\n <div class=\"highlight\">\n  <pre><span></span><span class=\"c1\"># File: fibonacci.pyx</span>\n\n<span class=\"k\">def</span> <span class=\"nf\">fib</span><span class=\"p\">(</span><span class=\"n\">n</span><span class=\"p\">):</span>\n    <span class=\"n\">a</span><span class=\"p\">,</span> <span class=\"n\">b</span> <span class=\"o\">=</span> <span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">1</span>\n    <span class=\"k\">while</span> <span class=\"n\">b</span> <span class=\"o\">&lt;</span> <span class=\"n\">n</span><span class=\"p\">:</span>\n        <span class=\"k\">print</span> <span class=\"n\">b</span><span class=\"p\">,</span>\n        <span class=\"n\">a</span><span class=\"p\">,</span> <span class=\"n\">b</span> <span class=\"o\">=</span> <span class=\"n\">b</span><span class=\"p\">,</span> <span class=\"n\">a</span> <span class=\"o\">+</span> <span class=\"n\">b</span>\n</pre></div>\n\n</div>\n\n<p>El resultado de compilar <code>fibonacci.pyx</code> es un fichero con código intermedio en C <code>fibonacci.c</code> y un fichero compilado <code>fibonacci.so</code>.</p>\n\n<div class=\"brush: bash\">\n <div class=\"highlight\">\n  <pre><span></span>$ python setup.py build\nrunning build\nrunning build_ext\nbuilding <span class=\"s1\">&#39;fibonacci&#39;</span> extension\n/usr/bin/clang ...snip... -o build/lib.macosx-10.8-x86_64-2.7/fibonacci.so\n</pre></div>\n\n</div>\n\n<blockquote>\n <p><strong>note</strong></p>\n <p>El compilador que se utiliza es el que sea por defecto del sistema en ese momento. Aún estoy investigando cómo seleccionar un compilador en concreto, o añadir librerías y flags.</p></blockquote>\n\n<p>El fichero .so puede usarse desde otros módulos de Python, o directamente desde la shell</p>\n\n<div class=\"brush: pycon\">\n <div class=\"highlight\">\n  <pre><span></span><span class=\"gp\">&gt;&gt;&gt; </span><span class=\"kn\">import</span> <span class=\"nn\">fibonacci</span>\n<span class=\"gp\">&gt;&gt;&gt; </span><span class=\"n\">fibonacci</span><span class=\"o\">.</span><span class=\"n\">fib</span><span class=\"p\">(</span><span class=\"mi\">5</span><span class=\"p\">)</span>\n<span class=\"go\">1 1 2 3</span>\n</pre></div>\n\n</div>")) ((? . 25) f post (u . "py2app excludes") (? . 25) 1535126483 (p+ #"/Users/luis/Documents/code/logc.github.io/blog/2013/12/02/py2app-excludes/index.html" . unix) (u . "/blog/2013/12/02/py2app-excludes/") (u . "2013-12-02T20:58:08Z+0100") (? . 24) (? . 15) (c (u . "python")) (u . "\n<p>Al generar una aplicación para Mac OS X con py2app, a menudo se generan ejecutables muy pesados, por ejemplo 20 MBs para una aplicación de línea de comandos (!).</p>\n\n<p>Uno de los problemas es que py2app tiende a incluir muchos módulos de la librería estándar de Python que en realidad no hacen falta. Se pueden excluir específicamente incluyéndolos en la opción excludes que se pasa a la función setup en el archivo setup.py usado para generar la aplicación.</p>\n\n<p>Con la lista siguiente, el peso baja de 22 MBs a 6 MBs. Probablemente se puede rebajar aún más.</p>\n\n<div class=\"brush: python\">\n <div class=\"highlight\">\n  <pre><span></span><span class=\"c1\"># File: setup.py</span>\n\n<span class=\"kn\">from</span> <span class=\"nn\">setuptools</span> <span class=\"kn\">import</span> <span class=\"n\">setup</span>\n\n<span class=\"n\">APP</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"s1\">&#39;path/main.py&#39;</span><span class=\"p\">]</span>\n<span class=\"n\">Plist</span> <span class=\"o\">=</span> <span class=\"p\">{}</span>\n<span class=\"n\">DATA_FILES</span> <span class=\"o\">=</span> <span class=\"p\">[]</span>\n<span class=\"n\">OPTIONS</span> <span class=\"o\">=</span> <span class=\"p\">{</span><span class=\"s1\">&#39;argv_emulation&#39;</span><span class=\"p\">:</span> <span class=\"bp\">True</span><span class=\"p\">,</span>\n           <span class=\"c1\">#&#39;iconfile&#39;: &#39;Icons/ConverterIcon.icns&#39;,</span>\n           <span class=\"s1\">&#39;plist&#39;</span><span class=\"p\">:</span> <span class=\"n\">Plist</span><span class=\"p\">,</span>\n           <span class=\"s1\">&#39;excludes&#39;</span><span class=\"p\">:</span> <span class=\"p\">[</span>\n               <span class=\"s1\">&#39;aetypes&#39;</span><span class=\"p\">,</span>\n               <span class=\"s1\">&#39;ast&#39;</span><span class=\"p\">,</span>\n               <span class=\"s1\">&#39;bz2&#39;</span><span class=\"p\">,</span>\n               <span class=\"s1\">&#39;calendar&#39;</span><span class=\"p\">,</span>\n               <span class=\"s1\">&#39;codecs&#39;</span><span class=\"p\">,</span>\n               <span class=\"s1\">&#39;collections&#39;</span><span class=\"p\">,</span>\n               <span class=\"s1\">&#39;ctypes&#39;</span><span class=\"p\">,</span>\n               <span class=\"s1\">&#39;distutils&#39;</span><span class=\"p\">,</span>\n               <span class=\"s1\">&#39;doctest&#39;</span><span class=\"p\">,</span>\n               <span class=\"s1\">&#39;email&#39;</span><span class=\"p\">,</span>\n               <span class=\"s1\">&#39;encodings&#39;</span><span class=\"p\">,</span>\n               <span class=\"s1\">&#39;functools&#39;</span><span class=\"p\">,</span>\n               <span class=\"s1\">&#39;gzip&#39;</span><span class=\"p\">,</span>\n               <span class=\"s1\">&#39;inspect&#39;</span><span class=\"p\">,</span>\n               <span class=\"s1\">&#39;itertools&#39;</span><span class=\"p\">,</span>\n               <span class=\"s1\">&#39;locale&#39;</span><span class=\"p\">,</span>\n               <span class=\"s1\">&#39;logging&#39;</span><span class=\"p\">,</span>\n               <span class=\"s1\">&#39;optparse&#39;</span><span class=\"p\">,</span>\n               <span class=\"s1\">&#39;pickle&#39;</span><span class=\"p\">,</span>\n               <span class=\"s1\">&#39;platform&#39;</span><span class=\"p\">,</span>\n               <span class=\"s1\">&#39;pprint&#39;</span><span class=\"p\">,</span>\n               <span class=\"s1\">&#39;random&#39;</span><span class=\"p\">,</span>\n               <span class=\"s1\">&#39;re&#39;</span><span class=\"p\">,</span>\n               <span class=\"s1\">&#39;sets&#39;</span><span class=\"p\">,</span>\n               <span class=\"s1\">&#39;shutil&#39;</span><span class=\"p\">,</span>\n               <span class=\"s1\">&#39;socket&#39;</span><span class=\"p\">,</span>\n               <span class=\"s1\">&#39;ssl&#39;</span><span class=\"p\">,</span>\n               <span class=\"s1\">&#39;subprocess&#39;</span><span class=\"p\">,</span>\n               <span class=\"s1\">&#39;tarfile&#39;</span><span class=\"p\">,</span>\n               <span class=\"s1\">&#39;tempfile&#39;</span><span class=\"p\">,</span>\n               <span class=\"s1\">&#39;threading&#39;</span><span class=\"p\">,</span>\n               <span class=\"s1\">&#39;traceback&#39;</span><span class=\"p\">,</span>\n               <span class=\"s1\">&#39;types&#39;</span><span class=\"p\">,</span>\n               <span class=\"s1\">&#39;unittest&#39;</span><span class=\"p\">,</span>\n               <span class=\"s1\">&#39;urllib&#39;</span><span class=\"p\">,</span>\n               <span class=\"s1\">&#39;urllib2&#39;</span><span class=\"p\">,</span>\n               <span class=\"s1\">&#39;urlparse&#39;</span><span class=\"p\">,</span>\n               <span class=\"s1\">&#39;weakref&#39;</span><span class=\"p\">,</span>\n               <span class=\"s1\">&#39;xml&#39;</span><span class=\"p\">,</span>\n               <span class=\"s1\">&#39;zipfile&#39;</span><span class=\"p\">,</span>\n           <span class=\"p\">]</span>\n           <span class=\"p\">}</span>\n\n<span class=\"n\">setup</span><span class=\"p\">(</span>\n    <span class=\"n\">app</span><span class=\"o\">=</span><span class=\"n\">APP</span><span class=\"p\">,</span>\n    <span class=\"n\">package_dir</span><span class=\"o\">=</span><span class=\"p\">{</span><span class=\"s1\">&#39;&#39;</span><span class=\"p\">:</span> <span class=\"s1\">&#39;src&#39;</span><span class=\"p\">},</span> <span class=\"c1\"># you may not need this</span>\n    <span class=\"n\">data_files</span><span class=\"o\">=</span><span class=\"n\">DATA_FILES</span><span class=\"p\">,</span>\n    <span class=\"n\">version</span><span class=\"o\">=</span><span class=\"s2\">\"0.1\"</span><span class=\"p\">,</span>\n    <span class=\"n\">description</span><span class=\"o\">=</span><span class=\"s2\">\"&lt;Your description&gt;\"</span><span class=\"p\">,</span>\n    <span class=\"n\">author</span><span class=\"o\">=</span><span class=\"s2\">\"&lt;Your name&gt;\"</span><span class=\"p\">,</span>\n    <span class=\"n\">author_email</span><span class=\"o\">=</span><span class=\"s2\">\"&lt;Your email&gt;\"</span><span class=\"p\">,</span>\n    <span class=\"n\">options</span><span class=\"o\">=</span><span class=\"p\">{</span><span class=\"s1\">&#39;py2app&#39;</span><span class=\"p\">:</span> <span class=\"n\">OPTIONS</span><span class=\"p\">},</span>\n    <span class=\"n\">setup_requires</span><span class=\"o\">=</span><span class=\"p\">[</span><span class=\"s1\">&#39;py2app&#39;</span><span class=\"p\">],</span>\n<span class=\"p\">)</span>\n</pre></div>\n\n</div>") #f (u . "\n<p>Al generar una aplicación para Mac OS X con py2app, a menudo se generan ejecutables muy pesados, por ejemplo 20 MBs para una aplicación de línea de comandos (!).</p>\n\n<p>Uno de los problemas es que py2app tiende a incluir muchos módulos de la librería estándar de Python que en realidad no hacen falta. Se pueden excluir específicamente incluyéndolos en la opción excludes que se pasa a la función setup en el archivo setup.py usado para generar la aplicación.</p>\n\n<p>Con la lista siguiente, el peso baja de 22 MBs a 6 MBs. Probablemente se puede rebajar aún más.</p>\n\n<div class=\"brush: python\">\n <div class=\"highlight\">\n  <pre><span></span><span class=\"c1\"># File: setup.py</span>\n\n<span class=\"kn\">from</span> <span class=\"nn\">setuptools</span> <span class=\"kn\">import</span> <span class=\"n\">setup</span>\n\n<span class=\"n\">APP</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"s1\">&#39;path/main.py&#39;</span><span class=\"p\">]</span>\n<span class=\"n\">Plist</span> <span class=\"o\">=</span> <span class=\"p\">{}</span>\n<span class=\"n\">DATA_FILES</span> <span class=\"o\">=</span> <span class=\"p\">[]</span>\n<span class=\"n\">OPTIONS</span> <span class=\"o\">=</span> <span class=\"p\">{</span><span class=\"s1\">&#39;argv_emulation&#39;</span><span class=\"p\">:</span> <span class=\"bp\">True</span><span class=\"p\">,</span>\n           <span class=\"c1\">#&#39;iconfile&#39;: &#39;Icons/ConverterIcon.icns&#39;,</span>\n           <span class=\"s1\">&#39;plist&#39;</span><span class=\"p\">:</span> <span class=\"n\">Plist</span><span class=\"p\">,</span>\n           <span class=\"s1\">&#39;excludes&#39;</span><span class=\"p\">:</span> <span class=\"p\">[</span>\n               <span class=\"s1\">&#39;aetypes&#39;</span><span class=\"p\">,</span>\n               <span class=\"s1\">&#39;ast&#39;</span><span class=\"p\">,</span>\n               <span class=\"s1\">&#39;bz2&#39;</span><span class=\"p\">,</span>\n               <span class=\"s1\">&#39;calendar&#39;</span><span class=\"p\">,</span>\n               <span class=\"s1\">&#39;codecs&#39;</span><span class=\"p\">,</span>\n               <span class=\"s1\">&#39;collections&#39;</span><span class=\"p\">,</span>\n               <span class=\"s1\">&#39;ctypes&#39;</span><span class=\"p\">,</span>\n               <span class=\"s1\">&#39;distutils&#39;</span><span class=\"p\">,</span>\n               <span class=\"s1\">&#39;doctest&#39;</span><span class=\"p\">,</span>\n               <span class=\"s1\">&#39;email&#39;</span><span class=\"p\">,</span>\n               <span class=\"s1\">&#39;encodings&#39;</span><span class=\"p\">,</span>\n               <span class=\"s1\">&#39;functools&#39;</span><span class=\"p\">,</span>\n               <span class=\"s1\">&#39;gzip&#39;</span><span class=\"p\">,</span>\n               <span class=\"s1\">&#39;inspect&#39;</span><span class=\"p\">,</span>\n               <span class=\"s1\">&#39;itertools&#39;</span><span class=\"p\">,</span>\n               <span class=\"s1\">&#39;locale&#39;</span><span class=\"p\">,</span>\n               <span class=\"s1\">&#39;logging&#39;</span><span class=\"p\">,</span>\n               <span class=\"s1\">&#39;optparse&#39;</span><span class=\"p\">,</span>\n               <span class=\"s1\">&#39;pickle&#39;</span><span class=\"p\">,</span>\n               <span class=\"s1\">&#39;platform&#39;</span><span class=\"p\">,</span>\n               <span class=\"s1\">&#39;pprint&#39;</span><span class=\"p\">,</span>\n               <span class=\"s1\">&#39;random&#39;</span><span class=\"p\">,</span>\n               <span class=\"s1\">&#39;re&#39;</span><span class=\"p\">,</span>\n               <span class=\"s1\">&#39;sets&#39;</span><span class=\"p\">,</span>\n               <span class=\"s1\">&#39;shutil&#39;</span><span class=\"p\">,</span>\n               <span class=\"s1\">&#39;socket&#39;</span><span class=\"p\">,</span>\n               <span class=\"s1\">&#39;ssl&#39;</span><span class=\"p\">,</span>\n               <span class=\"s1\">&#39;subprocess&#39;</span><span class=\"p\">,</span>\n               <span class=\"s1\">&#39;tarfile&#39;</span><span class=\"p\">,</span>\n               <span class=\"s1\">&#39;tempfile&#39;</span><span class=\"p\">,</span>\n               <span class=\"s1\">&#39;threading&#39;</span><span class=\"p\">,</span>\n               <span class=\"s1\">&#39;traceback&#39;</span><span class=\"p\">,</span>\n               <span class=\"s1\">&#39;types&#39;</span><span class=\"p\">,</span>\n               <span class=\"s1\">&#39;unittest&#39;</span><span class=\"p\">,</span>\n               <span class=\"s1\">&#39;urllib&#39;</span><span class=\"p\">,</span>\n               <span class=\"s1\">&#39;urllib2&#39;</span><span class=\"p\">,</span>\n               <span class=\"s1\">&#39;urlparse&#39;</span><span class=\"p\">,</span>\n               <span class=\"s1\">&#39;weakref&#39;</span><span class=\"p\">,</span>\n               <span class=\"s1\">&#39;xml&#39;</span><span class=\"p\">,</span>\n               <span class=\"s1\">&#39;zipfile&#39;</span><span class=\"p\">,</span>\n           <span class=\"p\">]</span>\n           <span class=\"p\">}</span>\n\n<span class=\"n\">setup</span><span class=\"p\">(</span>\n    <span class=\"n\">app</span><span class=\"o\">=</span><span class=\"n\">APP</span><span class=\"p\">,</span>\n    <span class=\"n\">package_dir</span><span class=\"o\">=</span><span class=\"p\">{</span><span class=\"s1\">&#39;&#39;</span><span class=\"p\">:</span> <span class=\"s1\">&#39;src&#39;</span><span class=\"p\">},</span> <span class=\"c1\"># you may not need this</span>\n    <span class=\"n\">data_files</span><span class=\"o\">=</span><span class=\"n\">DATA_FILES</span><span class=\"p\">,</span>\n    <span class=\"n\">version</span><span class=\"o\">=</span><span class=\"s2\">\"0.1\"</span><span class=\"p\">,</span>\n    <span class=\"n\">description</span><span class=\"o\">=</span><span class=\"s2\">\"&lt;Your description&gt;\"</span><span class=\"p\">,</span>\n    <span class=\"n\">author</span><span class=\"o\">=</span><span class=\"s2\">\"&lt;Your name&gt;\"</span><span class=\"p\">,</span>\n    <span class=\"n\">author_email</span><span class=\"o\">=</span><span class=\"s2\">\"&lt;Your email&gt;\"</span><span class=\"p\">,</span>\n    <span class=\"n\">options</span><span class=\"o\">=</span><span class=\"p\">{</span><span class=\"s1\">&#39;py2app&#39;</span><span class=\"p\">:</span> <span class=\"n\">OPTIONS</span><span class=\"p\">},</span>\n    <span class=\"n\">setup_requires</span><span class=\"o\">=</span><span class=\"p\">[</span><span class=\"s1\">&#39;py2app&#39;</span><span class=\"p\">],</span>\n<span class=\"p\">)</span>\n</pre></div>\n\n</div>")) ((? . 21) f post (u . "How do you develop with Yesod") (? . 21) 1535126483 (p+ #"/Users/luis/Documents/code/logc.github.io/blog/2013/12/04/how-do-you-develop-with-yesod/index.html" . unix) (u . "/blog/2013/12/04/how-do-you-develop-with-yesod/") (u . "2013-12-04T14:39:03Z+0100") (? . 9) (? . 20) (c (u . "haskell") c (u . "web")) (u . "\n<p>Yesod tutorials and examples can be found on the <a href=\"http://www.yesodweb.com/book\">Yesod book</a>, which is freely available online.</p>\n\n<p>However, many of the examples given are self-contained (which means that handler functions, data models and templates are defined in a single module, where a Warp web server is started as well). There is <a href=\"http://www.yesodweb.com/book/scaffolding-and-the-site-template\">a chapter that describes the scaffolded template</a>, i.e. what you get after you start with Yesod, but it is rather a description of its advantages and structure, not so much a detailed how-to.</p>\n\n<p>The purpose of this post is to explain to a new Yesod developer &ldquo;What do I do after &hellip; ?&rdquo; :</p>\n\n<div class=\"brush: console\">\n <div class=\"highlight\">\n  <pre><span></span><span class=\"gp\">$</span> yesod init\n</pre></div>\n\n</div>") #t (u . "\n<p>Yesod tutorials and examples can be found on the <a href=\"http://www.yesodweb.com/book\">Yesod book</a>, which is freely available online.</p>\n\n<p>However, many of the examples given are self-contained (which means that handler functions, data models and templates are defined in a single module, where a Warp web server is started as well). There is <a href=\"http://www.yesodweb.com/book/scaffolding-and-the-site-template\">a chapter that describes the scaffolded template</a>, i.e. what you get after you start with Yesod, but it is rather a description of its advantages and structure, not so much a detailed how-to.</p>\n\n<p>The purpose of this post is to explain to a new Yesod developer &ldquo;What do I do after &hellip; ?&rdquo; :</p>\n\n<div class=\"brush: console\">\n <div class=\"highlight\">\n  <pre><span></span><span class=\"gp\">$</span> yesod init\n</pre></div>\n\n</div>\n<!-- more-->\n\n<p>Briefly summarized, what you need after this command is:</p>\n\n<ol>\n <li>\n  <p>Describe the <strong>data models</strong> your Web application is going to store persistently</p></li>\n <li>\n  <p>Describe which <strong>routes</strong> are going to exist in your Web application</p></li>\n <li>\n  <p>Write the <strong>handler functions</strong> that answer requests to those routes</p></li>\n <li>\n  <p>Write the <strong>Hamlet templates</strong> that are filled out by the handler functions (and  possibly Lucius and Julius templates)</p></li></ol>\n\n<p>The <code>yesod add-handler</code> command automates the process of adding <strong>routes</strong> and <strong>handler functions</strong>.</p>\n\n<h3 id=\"adding-data-models\">Adding data models</h3>\n\n<p>A new data model has to be described in the <code>config/models</code> text file. With &ldquo;text file&rdquo; we mean that you write in &ldquo;near free&rdquo; syntax, but nevertheless many of the keywords are Haskell.</p>\n\n<h4 id=\"basics\">Basics</h4>\n\n<p>A new model consists of a name and a description of its fields. The description of fields consists, in turn, of a name and a type for the field. The type can be <code>Int</code>, <code>Text</code>, <code>UTCTime</code>, or other Haskell types. The type can also be qualified with a Monad (usually <code>Maybe</code>) and have a defaul value. Let&rsquo;s see a simple example:</p>\n\n<pre><code>Book\n    title Text\n    author Text\n    publisher Text Maybe\n    published UTCTime default=CURRENT_TIME</code></pre>\n\n<p>An identifier field is <strong>automatically added</strong> to each model. The name of that field is always <code>&lt;modelName&gt;Id</code>, e.g. for the previous model it would be <code>BookId</code>. This is a unique identifier stored in the database using the database mechanisms if available, or the Persistent module&rsquo;s mechanisms otherwise. We usually do not need to care about <strong>writing</strong> this ID, but we will be interested in <strong>reading</strong> it from the database, as we will see later.</p>\n\n<p>Another thing we get for free are <strong>accessor functions</strong> for each field. These are called <code>bookTitle</code> to get the title, <code>bookAuthor</code> to get the author, and so on&hellip;</p>\n\n<p>With the mentioned, you can create your own models. Let&rsquo;s review other features that are slightly more advanced but almost unavoidable in any app that is not completely trivial.</p>\n\n<h4 id=\"reference-other-models\">Reference other models</h4>\n\n<p>You can <strong>reference field in other models</strong>. This creates <em>foreign keys</em> in relational databases, or is managed by Persistent otherwise. You refer to the other model with an uppercase and join the name of model and field in camel case. An example is in the default models written by the scaffolding:</p>\n\n<pre><code>User\n    ...\nEmail\n    user UserId Maybe</code></pre>\n\n<p>This is also an example of using the automatically created field <code>UserId</code> for the User.</p>\n\n<h4 id=\"declare-records-to-be-unique\">Declare records to be unique</h4>\n\n<p>You can <strong>declare records to be unique with respect to a field</strong>. The unique ID are handed out to anything new in the store otherwise. You can specify that a record has to have a new value in one of its fields to be accepted. Again the default models provide an example of this:</p>\n\n<pre><code>User\n    ident Text\n    UniqueUser ident</code></pre>\n\n<h4 id=\"derive-typeclasses\">Derive typeclasses</h4>\n\n<p>And as a last note, you can directly <strong>declare your models to derive Haskell typeclasses</strong> e.g. Eq, Ord, Show. Which means the model, when loaded from database and available to be manipulated, will have the correct functions of that typeclass already implemented. ( In the case of Eq, it will be equatable, in the case of Ord, it will be comparable, and in the case of Show it will be printable; this, of course, in the case the compiler can deduce out of the fields composing the model how to implement such functions for you ).</p>\n\n<p>An example of deriving typeclasses:</p>\n\n<pre><code>Person\n    ...\n    deriving (Show)</code></pre>\n\n<h3 id=\"adding-routes\">Adding routes</h3>\n\n<p>You declare new routes to be answered to in the <code>config/routes</code> text file. This can be automated with the <code>yesod add-handler</code> command. However, let&rsquo;s review it to gain a bit of control on the underlying machinery.</p>\n\n<p>A new route starts from the root <code>/</code> and lists a <em>resource name</em> and <em>query parameters</em>. After that there is a space, and the name of the handler function(s) that handle requests to that particular route. Again a space, and a space-separated list of HTTP methods that are allowed on that route. An example with all of these:</p>\n\n<pre><code>/book/#BookId BookR GET PUT DELETE</code></pre>\n\n<p>where <code>book</code> is the <em>resource name</em>, <code>#BookId</code> is the <em>query parameter</em>, BookR is the shared part of the name of the <em>handler functions</em>, and the allowed methods are GET, PUT and DELETE.</p>\n\n<p>We say <code>BookR</code> is the shared part of the name because a single handler function is expected <strong>for each one of the allowed methods</strong>. That is, in the above example, <code>getBookR</code>, <code>putBookR</code> and <code>deleteBookR</code> are expected to exist somewhere (probably in a module called <code>Book</code> within the <code>Handlers</code> directory).</p>\n\n<p>Usually the convention for a REST API is that GET allows to see an instance of a model, POST allows to create an instance of a model, PUT allows to modify an instance of a model, and DELETE allows to, well, delete it.</p>\n\n<p>After you have added a new route, the application will not compile until there are handler functions for all of the new resources and allowed methods.</p>\n\n<h3 id=\"adding-handler-functions\">Adding handler functions</h3>\n\n<p>You add new functions to handle requests in modules under the <code>Handler</code> directory. This can be automated with the <code>yesod add-handler</code> command. However, let&rsquo;s review it to gain a bit of control on the underlying machinery.</p>\n\n<p>A handler function must exist <strong>for each resource and for each allowed HTTP method on that resource</strong>. That means if we declared the resource <code>/donkey</code> to accept requests with GET, POST and DELETE methods, then we have to implement <code>getDonkeyR</code>, <code>postDonkeyR</code> and <code>deleteDonkeyR</code>. The <code>R</code> means &ldquo;resource&rdquo;.</p>\n\n<p>Let us see a stub example of one of those functions:</p>\n\n<div class=\"brush: haskell\">\n <div class=\"highlight\">\n  <pre><span></span><span class=\"nf\">getDonkeyR</span> <span class=\"ow\">::</span> <span class=\"kt\">DonkeyId</span> <span class=\"ow\">-&gt;</span> <span class=\"kt\">Handler</span> <span class=\"kt\">Html</span>\n<span class=\"nf\">getDonkeyR</span> <span class=\"n\">donkeyId</span> <span class=\"ow\">=</span> <span class=\"n\">undefined</span>\n</pre></div>\n\n</div>\n\n<h4 id=\"handler-function-signature\">Handler function signature</h4>\n\n<p>Being a Haskell function, the function signature is important to understand what the function does.</p>\n\n<p>In the case of Yesod, the <strong>input to the function are query parameters</strong>, which are typed to correspond to model fields. That is, you do not get an integer, but a <code>DonkeyId</code> &mdash; if you specified in the route that the <code>donkey</code> resource has a query parameter of that type. This helps ensure that there are no typos in the <code>routes</code> and <code>models</code> text files that cause your app to fail on deployment.</p>\n\n<p>The <strong>output of the function</strong> is quite determined by Yesod, so it is easy to read, but you have to accept that the framework &ldquo;knows what it is doing&rdquo;. You usually have a <code>Handler Html</code> result type; which means that the result of your function is a function that knows how to answer a request with HTML. This function is what is going to be called by the application when it is running.</p>\n\n<p><em>Do not let that make your head explode</em>: it is like when you compile a function with gcc. It is not your source code that is run when the resulting binary is executed: it is the object representation of it. This is not exactly the same but for the moment, it is a good enough explanation.</p>\n\n<p>Other output types for the function are <code>Handler RepJson</code> if the function returns JSON, or even <code>Handler TypedContent</code> if the function returns HTML or JSON depending on what the client has requested.</p>\n\n<h4 id=\"handler-function-body\">Handler function body</h4>\n\n<p>In the function itself, you may want to do many different things. Let us discuss the most usual:</p>\n\n<ol>\n <li>\n  <p>getting something out of the database and into a template for viewing  ( <strong>Database -&gt; User</strong> )</p></li>\n <li>\n  <p>getting something out of a template form from the user, and inserting that  into the database ( <strong>User -&gt; Database</strong> )</p></li></ol>\n\n<h5 id=\"database---user\">Database -&gt; User</h5>\n\n<p>Consider the following function:</p>\n\n<div class=\"brush: haskell\">\n <div class=\"highlight\">\n  <pre><span></span><span class=\"nf\">getBooksR</span> <span class=\"ow\">::</span> <span class=\"kt\">Handler</span> <span class=\"kt\">Html</span>\n<span class=\"nf\">getBooksR</span> <span class=\"ow\">=</span> <span class=\"kr\">do</span>\n        <span class=\"n\">books</span> <span class=\"ow\">&lt;-</span> <span class=\"n\">runDB</span> <span class=\"o\">$</span> <span class=\"n\">selectList</span> <span class=\"kt\">[]</span> <span class=\"p\">[</span><span class=\"kt\">Asc</span> <span class=\"kt\">BookTitle</span><span class=\"p\">]</span>\n        <span class=\"p\">(</span><span class=\"n\">formWidget</span><span class=\"p\">,</span> <span class=\"n\">enctype</span><span class=\"p\">)</span> <span class=\"ow\">&lt;-</span> <span class=\"n\">generateFormPost</span> <span class=\"n\">bookForm</span>\n        <span class=\"n\">defaultLayout</span> <span class=\"o\">$</span><span class=\"p\">(</span><span class=\"n\">widgetFile</span> <span class=\"s\">\"books\"</span><span class=\"p\">)</span>\n</pre></div>\n\n</div>\n\n<p>The first line after <code>do</code> allows us to get a Book model out of the database. The <code>runDB</code> function runs any query on the database, while the <code>selectList</code> function composes a query that returns its results as a list. The empty first argument means we take <strong>all fields</strong> from each record, and the second argument accepts a number of filters and modifyers. The example shown is equivalent, in SQL, to:</p>\n\n<div class=\"brush: sql\">\n <div class=\"highlight\">\n  <pre><span></span><span class=\"k\">SELECT</span> <span class=\"o\">*</span> <span class=\"k\">FROM</span> <span class=\"n\">books</span> <span class=\"k\">ORDER</span> <span class=\"k\">BY</span> <span class=\"ss\">\"BookTitle\"</span> <span class=\"k\">ASC</span><span class=\"p\">;</span>\n</pre></div>\n\n</div>\n\n<p>Then we would go on to render the correct HTML template with the default layout. The template will have direct access to the <code>books</code> variable because it is in the same scope (the handler function). We will see how this happens when we discuss templates. The rendering happens with the line:</p>\n\n<div class=\"brush: haskell\">\n <div class=\"highlight\">\n  <pre><span></span><span class=\"nf\">defaultLayout</span> <span class=\"o\">$</span><span class=\"p\">(</span><span class=\"n\">widgetFile</span> <span class=\"s\">\"books\"</span><span class=\"p\">)</span>\n</pre></div>\n\n</div>\n\n<p>The template rendering takes the <code>defaultLayout</code> function, applied on the result of loading a widgetFile by name. The default layout renders the template found under <code>templates/default-layout.*</code> and includes within it the result of rendering whatever is on the <code>templates/books.*</code> files. This helps make the look and feel uniform across the website.</p>\n\n<p>(You may notice that we are skipping a line in the <code>getBooksR</code> function, between reading from database and rendering the template. It is concerned with <strong>form rendering</strong>, but for the sake of brevity we will not discuss it here)</p>\n\n<h5 id=\"user---database\">User -&gt; Database</h5>\n\n<p>Consider the following function:</p>\n\n<div class=\"brush: haskell\">\n <div class=\"highlight\">\n  <pre><span></span><span class=\"nf\">postBooksR</span> <span class=\"ow\">::</span> <span class=\"kt\">Handler</span> <span class=\"kt\">Html</span>\n<span class=\"nf\">postBooksR</span> <span class=\"ow\">=</span> <span class=\"kr\">do</span>\n    <span class=\"p\">((</span><span class=\"n\">result</span><span class=\"p\">,</span> <span class=\"kr\">_</span><span class=\"p\">),</span> <span class=\"kr\">_</span><span class=\"p\">)</span> <span class=\"ow\">&lt;-</span> <span class=\"n\">runFormPost</span> <span class=\"n\">bookForm</span>\n    <span class=\"kr\">case</span> <span class=\"n\">result</span> <span class=\"kr\">of</span>\n        <span class=\"kt\">FormSuccess</span> <span class=\"n\">book</span> <span class=\"ow\">-&gt;</span> <span class=\"kr\">do</span>\n            <span class=\"n\">bookid</span> <span class=\"ow\">&lt;-</span> <span class=\"n\">runDB</span> <span class=\"o\">$</span> <span class=\"n\">insert</span> <span class=\"n\">book</span>\n            <span class=\"n\">setMessage</span> <span class=\"s\">\"Book registered\"</span>\n        <span class=\"kr\">_</span> <span class=\"ow\">-&gt;</span> <span class=\"kr\">do</span>\n            <span class=\"n\">setMessage</span> <span class=\"s\">\"Invalid data\"</span>\n            <span class=\"n\">redirect</span> <span class=\"o\">$</span> <span class=\"kt\">BooksR</span>\n</pre></div>\n\n</div>\n\n<p>The first line after <code>do</code> gets the result out of a form that is defined and rendered elsewhere. The result may be a success, because all inputs are filled out and are of the expected types, or it may be anything else (an error), where we print an error message and do no more. If we have a success, then we can extract the specific <code>book</code> (of type <code>Book</code>) out of the <code>FormSuccess</code> monad via pattern matching, and then insert it into the DB via the Persist <code>insert</code> function:</p>\n\n<div class=\"brush: haskell\">\n <div class=\"highlight\">\n  <pre><span></span><span class=\"nf\">bookid</span> <span class=\"ow\">&lt;-</span> <span class=\"n\">runDB</span> <span class=\"o\">$</span> <span class=\"n\">insert</span> <span class=\"n\">book</span>\n</pre></div>\n\n</div>\n\n<p>Notice this works without any more specifications because we know, from the compile process, that the result of parsing the form contents must have enough informations to build a Book model, and a Book model can be written to database because we have already parsed it and created the necessary tables (in the case of a relational DB engine) on app startup.</p>\n\n<p>Notice also we receive a bookId as a result of inserting, but we can ignore it.</p>\n\n<h4 id=\"after-writing-your-handlers\">After writing your handlers</h4>\n\n<p>After writing your handlers, you must make the application aware that they exist. Import the relevant module in in the <code>Application</code> module, and also remember to list them in the <code>&lt;application&gt;.cabal</code> file, under <code>exposed-modules</code>. This makes the <code>cabal</code> build system know that it must include the new handler files in the compilation, and the <code>Application</code> module aware that it has to import those modules if it wants to answer the calls to some of the resources.</p>\n\n<h3 id=\"adding-hamlet-templates\">Adding Hamlet templates</h3>\n\n<p>We said earlier that the variables extracted from storage are rendered in the template. A template is a file that lives in the <code>templates</code> directory and is called whatever we want the <code>widgetFile</code> function to find.</p>\n\n<p>Hamlet is a template language that describes HTML to produce. A very short summary of Hamlet: you do not need to close HTML tags, this will be done for you. <em>With the important exception of links. Do not forget to close them with <code>&lt;/a&gt;</code></em>.</p>\n\n<p>In the template, you can refer to any variable that is available in the handler function (because the generated code is inserted in the function code directly before the results are produced). See this example template to render a Book model:</p>\n\n<pre><code>&lt;h2&gt; Book: #{bookTitle book}\n\n&lt;p&gt; by #{bookAuthor book}</code></pre>\n\n<p>Within the template, we can use the <strong>accessor functions</strong> we got for free out of the model definition. Remember that this is Haskell, so the function must go before the arguments. We drop into Haskell from the template by using <code>#{ }</code>.</p>\n\n<p>There is more syntax to iterate over a collection of <code>books</code> and control <code>if</code> we render some thing or the other depending on the presence of a variable, but we will skip this. There is Yesod documentation available.</p>\n\n<p>Let us mention another important feature of these templates: <strong>compiled in-site links</strong>. This means you refer to other pages within your website <em>through their resource names</em>, not through a simple string. In the homepage, for instance, you should include a link to the &ldquo;books&rdquo; page by using:</p>\n\n<pre><code>&lt;a href=@{BooksR}&gt;Add new book&lt;/a&gt;</code></pre>\n\n<p>Notice you use an <code>@</code>, not the <code>#</code> symbol.</p>\n\n<p>This makes it <strong>impossible for you to have dead links within the site</strong>. They are checked by the compiler on each site update, and the compilation will fail if there is something misspelled.</p>\n\n<h3 id=\"summing-up\">Summing up</h3>\n\n<p>We have reviewed what are the minimal changes you have to do to a scaffolded site in order to add a new feature to it, in some more depth than necessary since you can use <code>yesod add-handler</code> to make many of the changes for you. However, now you should understand better what is this command doing and why could it fail. The changes are:</p>\n\n<ol>\n <li>\n  <p>In <code>config/models</code>: describe <strong>data models</strong> stored</p></li>\n <li>\n  <p>In <code>config/routes</code>: describe <strong>routes</strong> served, as resources</p></li>\n <li>\n  <p>In <code>Handler/&lt;name&gt;.hs</code>: write <strong>handler functions</strong> that answer requests to  those routes; include them in <code>Application.hs</code> and list them on  <code>&lt;application&gt;.cabal</code></p></li>\n <li>\n  <p>In <code>templates/&lt;name&gt;.{hamlet,lucius,julius}</code>: write the <strong>templates</strong> that  are filled out by the handler functions</p></li></ol>")) ((? . 23) f post (u . "Setting up Github Pages with Frog") (? . 23) 1535126483 (p+ #"/Users/luis/Documents/code/logc.github.io/blog/2016/10/03/setting-up-github-pages-with-frog/index.html" . unix) (u . "/blog/2016/10/03/setting-up-github-pages-with-frog/") (u . "2016-10-03T20:24:03") (? . 3) (? . 22) (c (u . "racket") c (u . "frog") c (u . "blog")) (u . "\n<p>To set up a static blog in Github Pages using the Racket package Frog, you need to do the following:</p>\n\n<ul>\n <li>download and install Racket (duh!)</li>\n <li>install Frog with raco:</li></ul>\n\n<pre><code>$ raco install frog</code></pre>\n\n<ul>\n <li>create a folder and initialize a Frog project there:</li></ul>\n\n<pre><code>$ mkdir new-blog\n$ cd new-blog\n$ raco frog --init</code></pre>\n\n<ul>\n <li>\n  <p>customize the .frogrc file. Set at least scheme/host to https://your-username.github.io, and title &amp; author to whatever you want.</p></li>\n <li>\n  <p>add some content of your own:</p></li></ul>\n\n<pre><code>$ raco frog -n \"New post\"\n# ... output says something like:\n~/new-blog/_src/posts/2016-10-03-new-post.md\n# ... edit that file with your preferred editor ...\nwhen you are finished editing, preview your glorious site with\n\n$ raco frog -bp</code></pre>\n\n<ul>\n <li>initialize an empty Git repository on the project folder, and tell git to  ignore the Frog machinery and your source directory</li></ul>\n\n<pre><code>$ git init .\n$ cat &lt;&lt; EOF &gt; .gitignore\n/.frog/\n/.frogrc\n/_src/\nEOF</code></pre>\n\n<ul>\n <li>commit everything, except for what we just ignored</li></ul>\n\n<pre><code>$ git add .\n$ git commit</code></pre>\n\n<ul>\n <li>on github.com, create a new repository with the name your-username.github.io.  Once created, add it as a remote to your local repo, and push your local master  to it.</li></ul>\n\n<pre><code>$ git remote add origin &lt;your new repo&gt;\n$ git push -u origin master</code></pre>\n\n<ul>\n <li>after some seconds, your new blog should be available as http://your-username.github.io</li></ul>\n\n<p>Now, each time that you want to add a new post, it’s just a matter of</p>\n\n<pre><code>$ raco frog -n \"Another post\"\n# ... edit that post ...\n$ raco frog -b\n$ git add .\n$ git commit -a\n$ git push</code></pre>") #f (u . "\n<p>To set up a static blog in Github Pages using the Racket package Frog, you need to do the following:</p>\n\n<ul>\n <li>download and install Racket (duh!)</li>\n <li>install Frog with raco:</li></ul>\n\n<pre><code>$ raco install frog</code></pre>\n\n<ul>\n <li>create a folder and initialize a Frog project there:</li></ul>\n\n<pre><code>$ mkdir new-blog\n$ cd new-blog\n$ raco frog --init</code></pre>\n\n<ul>\n <li>\n  <p>customize the .frogrc file. Set at least scheme/host to https://your-username.github.io, and title &amp; author to whatever you want.</p></li>\n <li>\n  <p>add some content of your own:</p></li></ul>\n\n<pre><code>$ raco frog -n \"New post\"\n# ... output says something like:\n~/new-blog/_src/posts/2016-10-03-new-post.md\n# ... edit that file with your preferred editor ...\nwhen you are finished editing, preview your glorious site with\n\n$ raco frog -bp</code></pre>\n\n<ul>\n <li>initialize an empty Git repository on the project folder, and tell git to  ignore the Frog machinery and your source directory</li></ul>\n\n<pre><code>$ git init .\n$ cat &lt;&lt; EOF &gt; .gitignore\n/.frog/\n/.frogrc\n/_src/\nEOF</code></pre>\n\n<ul>\n <li>commit everything, except for what we just ignored</li></ul>\n\n<pre><code>$ git add .\n$ git commit</code></pre>\n\n<ul>\n <li>on github.com, create a new repository with the name your-username.github.io.  Once created, add it as a remote to your local repo, and push your local master  to it.</li></ul>\n\n<pre><code>$ git remote add origin &lt;your new repo&gt;\n$ git push -u origin master</code></pre>\n\n<ul>\n <li>after some seconds, your new blog should be available as http://your-username.github.io</li></ul>\n\n<p>Now, each time that you want to add a new post, it’s just a matter of</p>\n\n<pre><code>$ raco frog -n \"Another post\"\n# ... edit that post ...\n$ raco frog -b\n$ git add .\n$ git commit -a\n$ git push</code></pre>")) ((? . 14) f post (u . "Minimal Racket web app") (? . 14) 1535126483 (p+ #"/Users/luis/Documents/code/logc.github.io/blog/2017/12/19/minimal-racket-web-app/index.html" . unix) (u . "/blog/2017/12/19/minimal-racket-web-app/") (u . "2017-12-19T20:15:41") (? . 13) (? . 2) (c (u . "racket") c (u . "web")) (u . "\n<p>This is the simplest module that responds to HTTP requests.</p>\n\n<div class=\"brush: racket\">\n <div class=\"highlight\">\n  <pre><span></span><span class=\"kn\">#lang </span><span class=\"nn\">racket/base</span>\n\n<span class=\"p\">(</span><span class=\"k\"><a href=\"http://docs.racket-lang.org/reference/require.html#(form._((lib._racket/private/base..rkt)._require))\" style=\"color: inherit\">require</a></span>\n <span class=\"p\">(</span><span class=\"k\"><a href=\"http://docs.racket-lang.org/reference/require.html#(form._((lib._racket/private/base..rkt)._only-in))\" style=\"color: inherit\">only-in</a></span> <span class=\"n\">web-server/http</span>\n          <span class=\"n\">response/full</span><span class=\"p\">)</span>\n <span class=\"p\">(</span><span class=\"k\"><a href=\"http://docs.racket-lang.org/reference/require.html#(form._((lib._racket/private/base..rkt)._only-in))\" style=\"color: inherit\">only-in</a></span> <span class=\"n\">web-server/http/request-structs</span>\n          <span class=\"n\">make-header</span><span class=\"p\">)</span>\n <span class=\"p\">(</span><span class=\"k\"><a href=\"http://docs.racket-lang.org/reference/require.html#(form._((lib._racket/private/base..rkt)._only-in))\" style=\"color: inherit\">only-in</a></span> <span class=\"n\">web-server/servlet-env</span>\n          <span class=\"n\">serve/servlet</span><span class=\"p\">))</span>\n\n<span class=\"c1\">;; hello: request? -&gt; response?</span>\n<span class=\"p\">(</span><span class=\"k\"><a href=\"http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))\" style=\"color: inherit\">define</a></span> <span class=\"p\">(</span><span class=\"n\">hello</span> <span class=\"n\">req</span><span class=\"p\">)</span>\n  <span class=\"c1\">;; struct response/full</span>\n  <span class=\"p\">(</span><span class=\"n\">response/full</span>\n   <span class=\"mi\">200</span>                          <span class=\"c1\">;; code</span>\n   <span class=\"p\">(</span><span class=\"nb\"><a href=\"http://docs.racket-lang.org/reference/bytestrings.html#(def._((quote._~23~25kernel)._string-~3ebytes/utf-8))\" style=\"color: inherit\">string-&gt;bytes/utf-8</a></span> <span class=\"s2\">\"OK\"</span><span class=\"p\">)</span>   <span class=\"c1\">;; message</span>\n   <span class=\"p\">(</span><span class=\"nb\"><a href=\"http://docs.racket-lang.org/reference/time.html#(def._((quote._~23~25kernel)._current-seconds))\" style=\"color: inherit\">current-seconds</a></span><span class=\"p\">)</span>            <span class=\"c1\">;; timestamp in s</span>\n   <span class=\"no\">#f</span>                           <span class=\"c1\">;; mime or #f</span>\n   <span class=\"p\">(</span><span class=\"nb\"><a href=\"http://docs.racket-lang.org/reference/pairs.html#(def._((quote._~23~25kernel)._list))\" style=\"color: inherit\">list</a></span> <span class=\"p\">(</span><span class=\"n\">make-header</span>           <span class=\"c1\">;; list of headers</span>\n          <span class=\"p\">(</span><span class=\"nb\"><a href=\"http://docs.racket-lang.org/reference/bytestrings.html#(def._((quote._~23~25kernel)._string-~3ebytes/utf-8))\" style=\"color: inherit\">string-&gt;bytes/utf-8</a></span> <span class=\"s2\">\"Server\"</span><span class=\"p\">)</span>\n          <span class=\"p\">(</span><span class=\"nb\"><a href=\"http://docs.racket-lang.org/reference/bytestrings.html#(def._((quote._~23~25kernel)._string-~3ebytes/utf-8))\" style=\"color: inherit\">string-&gt;bytes/utf-8</a></span> <span class=\"s2\">\"Racket\"</span><span class=\"p\">)))</span>\n   <span class=\"p\">(</span><span class=\"nb\"><a href=\"http://docs.racket-lang.org/reference/pairs.html#(def._((quote._~23~25kernel)._list))\" style=\"color: inherit\">list</a></span>                        <span class=\"c1\">;; body: list of bytes</span>\n     <span class=\"p\">(</span><span class=\"nb\"><a href=\"http://docs.racket-lang.org/reference/bytestrings.html#(def._((quote._~23~25kernel)._string-~3ebytes/utf-8))\" style=\"color: inherit\">string-&gt;bytes/utf-8</a></span> <span class=\"s2\">\"Hello world!</span><span class=\"se\">\\n</span><span class=\"s2\">\"</span><span class=\"p\">))))</span>\n\n<span class=\"p\">(</span><span class=\"k\"><a href=\"http://docs.racket-lang.org/reference/module.html#(form._((lib._racket/private/base..rkt)._module+))\" style=\"color: inherit\">module+</a></span> <span class=\"n\">main</span>\n  <span class=\"p\">(</span><span class=\"n\">serve/servlet</span>\n   <span class=\"n\">hello</span>\n   <span class=\"kd\">#:port</span> <span class=\"mi\">8080</span>\n   <span class=\"kd\">#:servlet-regexp</span> <span class=\"sr\">#rx\"\"</span><span class=\"p\">))</span>\n</pre></div>\n\n</div>\n\n<p>Save it as <code>hello.rkt</code> and run it with <code>$ racket hello.rkt</code></p>\n\n<p>Check that it works:</p>\n\n<div class=\"brush: shell\">\n <div class=\"highlight\">\n  <pre><span></span>$ curl -v http://localhost:8080/\n*   Trying ::1...\n* TCP_NODELAY <span class=\"nb\">set</span>\n* Connection failed\n* connect to ::1 port <span class=\"m\">8080</span> failed: Connection refused\n*   Trying <span class=\"m\">127</span>.0.0.1...\n* TCP_NODELAY <span class=\"nb\">set</span>\n* Connected to localhost <span class=\"o\">(</span><span class=\"m\">127</span>.0.0.1<span class=\"o\">)</span> port <span class=\"m\">8080</span> <span class=\"o\">(</span><span class=\"c1\">#0)</span>\n&gt; GET / HTTP/1.1\n&gt; Host: localhost:8080\n&gt; User-Agent: curl/7.54.0\n&gt; Accept: */*\n&gt;\n&lt; HTTP/1.1 <span class=\"m\">200</span> OK\n&lt; Date: Tue, <span class=\"m\">19</span> Dec <span class=\"m\">2017</span> <span class=\"m\">18</span>:13:14 GMT\n&lt; Last-Modified: Tue, <span class=\"m\">19</span> Dec <span class=\"m\">2017</span> <span class=\"m\">18</span>:13:14 GMT\n&lt; Content-Length: <span class=\"m\">13</span>\n&lt; Server: Racket\n&lt;\nHello world!\n* Connection <span class=\"c1\">#0 to host localhost left intact</span>\n</pre></div>\n\n</div>") #f (u . "\n<p>This is the simplest module that responds to HTTP requests.</p>\n\n<div class=\"brush: racket\">\n <div class=\"highlight\">\n  <pre><span></span><span class=\"kn\">#lang </span><span class=\"nn\">racket/base</span>\n\n<span class=\"p\">(</span><span class=\"k\"><a href=\"http://docs.racket-lang.org/reference/require.html#(form._((lib._racket/private/base..rkt)._require))\" style=\"color: inherit\">require</a></span>\n <span class=\"p\">(</span><span class=\"k\"><a href=\"http://docs.racket-lang.org/reference/require.html#(form._((lib._racket/private/base..rkt)._only-in))\" style=\"color: inherit\">only-in</a></span> <span class=\"n\">web-server/http</span>\n          <span class=\"n\">response/full</span><span class=\"p\">)</span>\n <span class=\"p\">(</span><span class=\"k\"><a href=\"http://docs.racket-lang.org/reference/require.html#(form._((lib._racket/private/base..rkt)._only-in))\" style=\"color: inherit\">only-in</a></span> <span class=\"n\">web-server/http/request-structs</span>\n          <span class=\"n\">make-header</span><span class=\"p\">)</span>\n <span class=\"p\">(</span><span class=\"k\"><a href=\"http://docs.racket-lang.org/reference/require.html#(form._((lib._racket/private/base..rkt)._only-in))\" style=\"color: inherit\">only-in</a></span> <span class=\"n\">web-server/servlet-env</span>\n          <span class=\"n\">serve/servlet</span><span class=\"p\">))</span>\n\n<span class=\"c1\">;; hello: request? -&gt; response?</span>\n<span class=\"p\">(</span><span class=\"k\"><a href=\"http://docs.racket-lang.org/reference/define.html#(form._((lib._racket/private/base..rkt)._define))\" style=\"color: inherit\">define</a></span> <span class=\"p\">(</span><span class=\"n\">hello</span> <span class=\"n\">req</span><span class=\"p\">)</span>\n  <span class=\"c1\">;; struct response/full</span>\n  <span class=\"p\">(</span><span class=\"n\">response/full</span>\n   <span class=\"mi\">200</span>                          <span class=\"c1\">;; code</span>\n   <span class=\"p\">(</span><span class=\"nb\"><a href=\"http://docs.racket-lang.org/reference/bytestrings.html#(def._((quote._~23~25kernel)._string-~3ebytes/utf-8))\" style=\"color: inherit\">string-&gt;bytes/utf-8</a></span> <span class=\"s2\">\"OK\"</span><span class=\"p\">)</span>   <span class=\"c1\">;; message</span>\n   <span class=\"p\">(</span><span class=\"nb\"><a href=\"http://docs.racket-lang.org/reference/time.html#(def._((quote._~23~25kernel)._current-seconds))\" style=\"color: inherit\">current-seconds</a></span><span class=\"p\">)</span>            <span class=\"c1\">;; timestamp in s</span>\n   <span class=\"no\">#f</span>                           <span class=\"c1\">;; mime or #f</span>\n   <span class=\"p\">(</span><span class=\"nb\"><a href=\"http://docs.racket-lang.org/reference/pairs.html#(def._((quote._~23~25kernel)._list))\" style=\"color: inherit\">list</a></span> <span class=\"p\">(</span><span class=\"n\">make-header</span>           <span class=\"c1\">;; list of headers</span>\n          <span class=\"p\">(</span><span class=\"nb\"><a href=\"http://docs.racket-lang.org/reference/bytestrings.html#(def._((quote._~23~25kernel)._string-~3ebytes/utf-8))\" style=\"color: inherit\">string-&gt;bytes/utf-8</a></span> <span class=\"s2\">\"Server\"</span><span class=\"p\">)</span>\n          <span class=\"p\">(</span><span class=\"nb\"><a href=\"http://docs.racket-lang.org/reference/bytestrings.html#(def._((quote._~23~25kernel)._string-~3ebytes/utf-8))\" style=\"color: inherit\">string-&gt;bytes/utf-8</a></span> <span class=\"s2\">\"Racket\"</span><span class=\"p\">)))</span>\n   <span class=\"p\">(</span><span class=\"nb\"><a href=\"http://docs.racket-lang.org/reference/pairs.html#(def._((quote._~23~25kernel)._list))\" style=\"color: inherit\">list</a></span>                        <span class=\"c1\">;; body: list of bytes</span>\n     <span class=\"p\">(</span><span class=\"nb\"><a href=\"http://docs.racket-lang.org/reference/bytestrings.html#(def._((quote._~23~25kernel)._string-~3ebytes/utf-8))\" style=\"color: inherit\">string-&gt;bytes/utf-8</a></span> <span class=\"s2\">\"Hello world!</span><span class=\"se\">\\n</span><span class=\"s2\">\"</span><span class=\"p\">))))</span>\n\n<span class=\"p\">(</span><span class=\"k\"><a href=\"http://docs.racket-lang.org/reference/module.html#(form._((lib._racket/private/base..rkt)._module+))\" style=\"color: inherit\">module+</a></span> <span class=\"n\">main</span>\n  <span class=\"p\">(</span><span class=\"n\">serve/servlet</span>\n   <span class=\"n\">hello</span>\n   <span class=\"kd\">#:port</span> <span class=\"mi\">8080</span>\n   <span class=\"kd\">#:servlet-regexp</span> <span class=\"sr\">#rx\"\"</span><span class=\"p\">))</span>\n</pre></div>\n\n</div>\n\n<p>Save it as <code>hello.rkt</code> and run it with <code>$ racket hello.rkt</code></p>\n\n<p>Check that it works:</p>\n\n<div class=\"brush: shell\">\n <div class=\"highlight\">\n  <pre><span></span>$ curl -v http://localhost:8080/\n*   Trying ::1...\n* TCP_NODELAY <span class=\"nb\">set</span>\n* Connection failed\n* connect to ::1 port <span class=\"m\">8080</span> failed: Connection refused\n*   Trying <span class=\"m\">127</span>.0.0.1...\n* TCP_NODELAY <span class=\"nb\">set</span>\n* Connected to localhost <span class=\"o\">(</span><span class=\"m\">127</span>.0.0.1<span class=\"o\">)</span> port <span class=\"m\">8080</span> <span class=\"o\">(</span><span class=\"c1\">#0)</span>\n&gt; GET / HTTP/1.1\n&gt; Host: localhost:8080\n&gt; User-Agent: curl/7.54.0\n&gt; Accept: */*\n&gt;\n&lt; HTTP/1.1 <span class=\"m\">200</span> OK\n&lt; Date: Tue, <span class=\"m\">19</span> Dec <span class=\"m\">2017</span> <span class=\"m\">18</span>:13:14 GMT\n&lt; Last-Modified: Tue, <span class=\"m\">19</span> Dec <span class=\"m\">2017</span> <span class=\"m\">18</span>:13:14 GMT\n&lt; Content-Length: <span class=\"m\">13</span>\n&lt; Server: Racket\n&lt;\nHello world!\n* Connection <span class=\"c1\">#0 to host localhost left intact</span>\n</pre></div>\n\n</div>")) ((? . 19) f post (u . "IntelliJ context menu from keyboard") (? . 19) 1535126483 (p+ #"/Users/luis/Documents/code/logc.github.io/blog/2017/08/24/intellij-context-menu-from-keyboard/index.html" . unix) (u . "/blog/2017/08/24/intellij-context-menu-from-keyboard/") (u . "2017-08-24T16:33:11") (? . 11) (? . 18) (c (u . "IntelliJ")) (u . "\n<p>Looked for this for a long time. Somehow, never found <a href=\"https://intellij-support.jetbrains.com/hc/en-us/community/posts/206326619-Invoke-popup-menu-from-keyboard\">the existing support answer</a>. Just created a new shortcut on my personal keymap, with &ldquo;Ctrl + Shift + Enter&rdquo; =&gt; a new life.</p>") #f (u . "\n<p>Looked for this for a long time. Somehow, never found <a href=\"https://intellij-support.jetbrains.com/hc/en-us/community/posts/206326619-Invoke-popup-menu-from-keyboard\">the existing support answer</a>. Just created a new shortcut on my personal keymap, with &ldquo;Ctrl + Shift + Enter&rdquo; =&gt; a new life.</p>")) ((? . 7) f post (u . "If programming languages were music genres") (? . 7) 1535126483 (p+ #"/Users/luis/Documents/code/logc.github.io/blog/2015/02/27/if-programming-languages-were-music-genres/index.html" . unix) (u . "/blog/2015/02/27/if-programming-languages-were-music-genres/") (u . "2015-02-27T16:52:41Z+0100") (? . 6) (? . 0) (c (u . "programming")) (u . "\n<p>There are quite some posts out there that compare programming languages to something else, like religions, rock bands, types of women &hellip; There is a <a href=\"http://lambda-the-ultimate.org/node/3133\">compilation of these over at Lambda the Ultimate</a>.</p>\n\n<p>One comparison that I find missing is that of programming languages to music genres (maybe the &ldquo;Subcultures&rdquo; post was simmilar, but it seems to be a dead link now). This is the more surprising since it looks like developers tend to argue about their favourite languages just like most people about music: everyone knows it is a highly subjective preference, but no-one escapes trying to convince others that they are not listening to the &ldquo;right&rdquo; music!</p>\n\n<p>So, here is my (completely subjective) view on programming languages as music genres:</p>") #t (u . "\n<p>There are quite some posts out there that compare programming languages to something else, like religions, rock bands, types of women &hellip; There is a <a href=\"http://lambda-the-ultimate.org/node/3133\">compilation of these over at Lambda the Ultimate</a>.</p>\n\n<p>One comparison that I find missing is that of programming languages to music genres (maybe the &ldquo;Subcultures&rdquo; post was simmilar, but it seems to be a dead link now). This is the more surprising since it looks like developers tend to argue about their favourite languages just like most people about music: everyone knows it is a highly subjective preference, but no-one escapes trying to convince others that they are not listening to the &ldquo;right&rdquo; music!</p>\n\n<p>So, here is my (completely subjective) view on programming languages as music genres:</p>\n<!-- more-->\n\n<ul>\n <li><strong>C: punk rock</strong> It only has three chords, it was born in the late 70&rsquo;s, and,  despite several reports to the contrary, it is not dead yet.</li>\n <li><strong>C++: heavy metal</strong> It claims to be similar but more technical than C, it is  subdivided in dozens of different subgenres that you will never totally  master, and despite the whole technical allure, at some point you start  thinking it is a bit commercial and superficial.</li>\n <li><strong>Java: techno</strong> No one likes it really, but peer pressure drives you at some  point to go to a place where they are playing it loudly, and you have to do  as if you enjoy it.</li>\n <li><strong>Python: blues rock</strong> It does what C does, but slower and with one and two  more chords thrown here and there. Everyone likes it for a while, but then,  after some hours of listening to it, you start wondering if there is something  else.</li>\n <li><strong>Ruby: reggae</strong> Coming from an exotic place, it has gained mainstream  acceptance, it is as slow as Python, and people in that scene tend to regard  themselves as cool without further explanation.</li>\n <li><strong>LISP: classical music</strong> Someone in a position of authority told you long  ago to learn its basics because it was important for your education, you  thought at the time that it was a hateful and obsolete past-time, but as time  goes by, you go back to it and find comfort in its beauty.</li>\n <li><strong>Haskell: mathcore</strong> Not everyone knows it, and those who do think they are  some kind of elite. It is 100% faster and more complex than anything else  out there. It is several layers of purity removed from C, although they  share some distant roots.</li>\n <li><strong>Erlang: world music</strong> A lot of different musical styles thrown together and  whose unifying trait seems to be that, apparently, very few people listen to  them.</li>\n <li><strong>Clojure: hip hop</strong> The base is made with the same tools as techno, but with  old soul records played on top. Who would have thought that those sweet  performers from Motown sounded so aggresive when played with a bad attitude?</li>\n <li><strong>Scala: rap rock</strong> It tries to bring together the best of two worlds and it  largely succeeds. The hardcore fans of each camp will deny there is any need  to blend their styles together, but from time to time find themselves  listening to it and nodding.</li></ul>"))))